<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"
    />
    <title>Cyber Detective</title>
    <link
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%230a0a12' width='100' height='100' rx='20'/><circle cx='40' cy='40' r='20' fill='none' stroke='%2300ffff' stroke-width='6'/><line x1='55' y1='55' x2='75' y2='75' stroke='%2300ffff' stroke-width='6' stroke-linecap='round'/><circle cx='70' cy='30' r='8' fill='%23ff3366'/><path d='M65 30 h10 M70 25 v10' stroke='white' stroke-width='2'/></svg>"
    />
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@400;700&display=swap");
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        background: #000;
        overflow: hidden;
        font-family: "Segoe UI", sans-serif;
      }
      #loader,
      #suspended {
        position: fixed;
        inset: 0;
        background: linear-gradient(135deg, #0a0a12, #1a1a2e);
        z-index: 3000;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 20px;
        text-align: center;
      }
      #loader-logo {
        width: 120px;
        height: 120px;
        margin-bottom: 30px;
        animation: pulse-logo 2s ease-in-out infinite;
      }
      @keyframes pulse-logo {
        0%,
        100% {
          filter: drop-shadow(0 0 20px #0ff);
        }
        50% {
          filter: drop-shadow(0 0 40px #0ff);
        }
      }
      #loader h1 {
        font-family: "Orbitron";
        font-size: clamp(20px, 5vw, 32px);
        color: #0ff;
        text-shadow: 0 0 30px #0ff;
        margin-bottom: 30px;
      }
      #loader-bar-container {
        width: 80%;
        max-width: 400px;
        height: 20px;
        background: #1a1a2e;
        border: 2px solid #0ff;
        border-radius: 10px;
        overflow: hidden;
        margin-bottom: 15px;
      }
      #loader-bar {
        width: 0%;
        height: 100%;
        background: linear-gradient(90deg, #0ff, #0f8);
        border-radius: 8px;
        transition: width 0.3s ease;
      }
      #loader-percent {
        font-family: "Orbitron";
        font-size: 24px;
        color: #0ff;
        margin-bottom: 10px;
      }
      #loader-text {
        font-family: "Share Tech Mono";
        font-size: 14px;
        color: #888;
      }
      #suspended h1 {
        font-family: "Orbitron";
        color: #f36;
        font-size: 28px;
        margin-bottom: 20px;
      }
      #suspended p {
        color: #aaa;
        margin-bottom: 10px;
      }
      #suspended .time {
        font-family: "Orbitron";
        color: #fc0;
        font-size: 36px;
        margin: 20px 0;
      }
      #intro {
        position: fixed;
        inset: 0;
        background: linear-gradient(135deg, #0a0a12, #1a1a2e);
        z-index: 2000;
        display: none;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 20px;
        text-align: center;
      }
      #intro h1 {
        font-family: "Orbitron";
        font-size: clamp(28px, 8vw, 50px);
        color: #0ff;
        text-shadow: 0 0 50px #0ff;
        margin-bottom: 15px;
      }
      #intro p {
        color: #888;
        margin-bottom: 40px;
      }
      #intro button {
        background: transparent;
        border: 2px solid #0ff;
        color: #0ff;
        padding: 15px 50px;
        font-family: "Orbitron";
        cursor: pointer;
      }
      canvas {
        display: block;
      }
      #crosshair {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 20px;
        height: 20px;
        pointer-events: none;
        z-index: 100;
      }
      #crosshair::before,
      #crosshair::after {
        content: "";
        position: absolute;
        background: #0ff;
      }
      #crosshair::before {
        width: 2px;
        height: 100%;
        left: 50%;
        transform: translateX(-50%);
      }
      #crosshair::after {
        width: 100%;
        height: 2px;
        top: 50%;
        transform: translateY(-50%);
      }
      #prompt {
        position: fixed;
        bottom: 20%;
        left: 50%;
        transform: translateX(-50%);
        color: #0ff;
        font-family: "Share Tech Mono";
        background: rgba(0, 20, 30, 0.9);
        padding: 12px 24px;
        border: 2px solid #0ff;
        border-radius: 8px;
        opacity: 0;
        z-index: 100;
      }
      #touch-btn {
        display: none;
        position: fixed;
        bottom: 80px;
        left: 50%;
        transform: translateX(-50%);
        background: linear-gradient(135deg, #0ff, #0f8);
        color: #000;
        font-family: "Orbitron", sans-serif;
        font-weight: bold;
        padding: 18px 40px;
        border-radius: 30px;
        font-size: 16px;
        z-index: 100;
        cursor: pointer;
      }
      #hud {
        position: fixed;
        top: 10px;
        left: 10px;
        color: #0ff;
        font-family: "Share Tech Mono";
        font-size: 13px;
        z-index: 100;
      }
      #hud div {
        margin-bottom: 4px;
        padding: 5px 10px;
        background: rgba(0, 255, 255, 0.15);
        border-left: 3px solid #0ff;
      }
      #computer {
        position: fixed;
        inset: 0;
        background: #0a0a12;
        z-index: 500;
        display: none;
        flex-direction: column;
      }
      #computer-bar {
        height: 45px;
        background: #1a1a2e;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 12px;
        border-bottom: 1px solid #333;
      }
      #computer-bar span {
        font-family: "Orbitron";
        color: #0ff;
      }
      #computer-bar button {
        background: #f36;
        color: #fff;
        border: none;
        padding: 8px 16px;
        cursor: pointer;
        border-radius: 5px;
      }
      #computer-main {
        flex: 1;
        display: flex;
        overflow: hidden;
      }
      #sidebar {
        width: 60px;
        background: #0f0f1a;
        border-right: 1px solid #1a1a2e;
        padding: 8px;
      }
      .nav-item {
        padding: 14px 8px;
        margin-bottom: 4px;
        background: rgba(0, 255, 255, 0.05);
        color: #888;
        font-size: 20px;
        cursor: pointer;
        border-left: 3px solid transparent;
        text-align: center;
        border-radius: 0 5px 5px 0;
      }
      .nav-item:hover,
      .nav-item.active {
        background: rgba(0, 255, 255, 0.15);
        color: #0ff;
        border-color: #0ff;
      }
      .nav-item.notify {
        background: rgba(255, 51, 102, 0.2);
        border-color: #f36;
      }
      #content {
        flex: 1;
        padding: 15px;
        overflow-y: auto;
      }
      .panel {
        background: #0f0f1a;
        border: 1px solid #1a1a2e;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 15px;
      }
      .panel h2 {
        font-family: "Orbitron";
        color: #0ff;
        margin-bottom: 12px;
        font-size: 16px;
      }
      .case-card {
        background: #1a1a2e;
        border: 2px solid #2a2a4e;
        border-radius: 8px;
        padding: 12px;
        margin-bottom: 10px;
        cursor: pointer;
      }
      .case-card:hover,
      .case-card.active {
        border-color: #0ff;
      }
      .case-card h4 {
        color: #fff;
        font-size: 14px;
      }
      .case-card p {
        color: #888;
        font-size: 12px;
      }
      .evidence-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 10px;
      }
      .evidence-card {
        background: #1a1a2e;
        border: 2px solid #2a2a4e;
        border-radius: 8px;
        padding: 10px;
        cursor: pointer;
      }
      .evidence-card:hover {
        border-color: #0ff;
      }
      .evidence-img {
        height: 80px;
        background: #0a0a12;
        border-radius: 5px;
        margin-bottom: 8px;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .evidence-img img {
        max-width: 100%;
        max-height: 100%;
      }
      .badge {
        font-size: 10px;
        padding: 3px 8px;
        border-radius: 4px;
      }
      .badge-pending {
        background: rgba(255, 153, 0, 0.3);
        color: #f90;
      }
      .badge-ok {
        background: rgba(0, 255, 136, 0.3);
        color: #0f8;
      }
      .badge-fake {
        background: rgba(255, 51, 102, 0.3);
        color: #f36;
      }
      .recipient-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
        margin: 10px 0;
      }
      .recipient-opt {
        background: #1a1a2e;
        border: 2px solid #2a2a4e;
        padding: 12px;
        text-align: center;
        border-radius: 8px;
        cursor: pointer;
      }
      .recipient-opt:hover,
      .recipient-opt.selected {
        border-color: #0ff;
        background: rgba(0, 255, 255, 0.1);
      }
      .recipient-opt .icon {
        font-size: 24px;
      }
      .recipient-opt .name {
        color: #fff;
        font-size: 11px;
      }
      .send-btn {
        width: 100%;
        background: linear-gradient(135deg, #0f8, #0ff);
        color: #000;
        border: none;
        padding: 14px;
        font-family: "Orbitron";
        cursor: pointer;
        border-radius: 8px;
        margin-top: 10px;
      }
      .send-btn:disabled {
        background: #333;
        color: #666;
      }
      #analysis {
        position: fixed;
        inset: 0;
        background: #000;
        z-index: 600;
        display: none;
        flex-direction: column;
      }
      #analysis-header {
        background: #1a1a2e;
        padding: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      #analysis-header h2 {
        font-family: "Orbitron";
        color: #0ff;
        font-size: 14px;
      }
      #analysis-header button {
        background: #f36;
        border: none;
        color: #fff;
        padding: 8px 15px;
        cursor: pointer;
        border-radius: 5px;
      }
      #analysis-body {
        flex: 1;
        display: flex;
        flex-direction: column;
      }
      #img-viewer {
        flex: 1;
        background: #050508;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
      }
      #img-viewer img {
        max-width: 95%;
        max-height: 50vh;
        transition: transform 0.3s;
        cursor: zoom-in;
      }
      #tools-panel {
        background: #0a0a12;
        padding: 10px;
        overflow-y: auto;
        max-height: 40vh;
      }
      .tool-btn {
        width: 100%;
        padding: 10px;
        margin-bottom: 5px;
        background: #1a1a2e;
        border: 2px solid #2a2a4e;
        color: #888;
        font-size: 12px;
        cursor: pointer;
        text-align: left;
        border-radius: 5px;
      }
      .tool-btn:hover {
        border-color: #0ff;
        color: #0ff;
      }
      .tool-btn.locked {
        opacity: 0.4;
      }
      .tool-btn.active {
        border-color: #0f8;
        color: #0f8;
      }
      #results-box {
        background: #1a1a2e;
        padding: 10px;
        border-radius: 5px;
        margin: 10px 0;
        max-height: 100px;
        overflow-y: auto;
      }
      .result-row {
        display: flex;
        justify-content: space-between;
        padding: 4px 0;
        font-size: 11px;
      }
      .result-val.sus {
        color: #f90;
      }
      .result-val.ok {
        color: #0f8;
      }
      #verdict-btns {
        display: flex;
        gap: 10px;
      }
      .verdict-btn {
        flex: 1;
        padding: 12px;
        border: 2px solid;
        background: transparent;
        font-family: "Orbitron";
        font-size: 12px;
        cursor: pointer;
        border-radius: 8px;
      }
      .v-ok {
        border-color: #0f8;
        color: #0f8;
      }
      .v-fake {
        border-color: #f36;
        color: #f36;
      }
      #visitor {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.95);
        z-index: 400;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 15px;
      }
      #visitor-box {
        background: #1a1a2e;
        border: 2px solid #0ff;
        border-radius: 15px;
        padding: 20px;
        max-width: 400px;
        width: 100%;
      }
      .visitor-head {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 15px;
      }
      .visitor-avatar {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: #0ff;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
      }
      #visitor-complaint {
        color: #ddd;
        margin-bottom: 15px;
        padding: 12px;
        background: #0a0a12;
        border-radius: 8px;
        border-left: 3px solid #f90;
        max-height: 200px;
        overflow-y: auto;
        font-size: 13px;
        line-height: 1.5;
      }
      .visitor-btns {
        display: flex;
        gap: 10px;
      }
      .visitor-btns button {
        flex: 1;
        padding: 12px;
        font-family: "Orbitron";
        border-radius: 8px;
        cursor: pointer;
      }
      #btn-accept {
        background: #0ff;
        color: #000;
        border: none;
      }
      #btn-reject {
        background: transparent;
        border: 2px solid #f36;
        color: #f36;
      }
      #result {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.95);
        z-index: 700;
        display: none;
        align-items: center;
        justify-content: center;
      }
      #result-box {
        text-align: center;
      }
      #result-icon {
        font-size: 60px;
      }
      #result-title {
        font-family: "Orbitron";
        font-size: 24px;
        margin: 10px 0;
      }
      #result-msg {
        color: #aaa;
        margin-bottom: 15px;
      }
      #result-reward {
        font-family: "Orbitron";
        font-size: 20px;
        margin-bottom: 20px;
      }
      #result button {
        background: #0ff;
        color: #000;
        border: none;
        padding: 12px 30px;
        font-family: "Orbitron";
        cursor: pointer;
        border-radius: 8px;
      }
      #notif {
        position: fixed;
        top: 60px;
        right: 10px;
        background: #1a1a2e;
        border: 2px solid #0ff;
        border-radius: 10px;
        padding: 12px;
        z-index: 1000;
        display: none;
        max-width: 200px;
      }
      #notif h4 {
        color: #0ff;
        font-size: 11px;
      }
      #notif p {
        color: #aaa;
        font-size: 11px;
      }
      .shop-item {
        background: #1a1a2e;
        border: 2px solid #2a2a4e;
        border-radius: 8px;
        padding: 12px;
        margin-bottom: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .shop-btn {
        background: #fc0;
        color: #000;
        border: none;
        padding: 8px 15px;
        cursor: pointer;
        border-radius: 5px;
      }
      .shop-btn:disabled {
        background: #333;
        color: #666;
      }
      .mail-item {
        background: #1a1a2e;
        border: 2px solid #2a2a4e;
        border-radius: 8px;
        padding: 10px;
        margin-bottom: 8px;
        cursor: pointer;
      }
      .mail-item.unread {
        border-left: 4px solid #0ff;
      }
      #scene-overlay {
        position: fixed;
        inset: 0;
        background: #000;
        z-index: 800;
        display: none;
        flex-direction: column;
      }
      #scene-canvas {
        width: 100%;
        height: 40vh;
      }
      #scene-ui {
        padding: 15px;
        overflow-y: auto;
        flex: 1;
        background: linear-gradient(transparent, rgba(0, 0, 0, 0.9));
      }
      #scene-dialogue {
        background: #1a1a2e;
        border: 2px solid #0ff;
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 10px;
      }
      .scene-speaker {
        font-family: "Orbitron";
        font-size: 14px;
        margin-bottom: 8px;
      }
      .scene-speaker.judge {
        color: #fc0;
      }
      .scene-speaker.police {
        color: #36f;
      }
      .scene-speaker.defense {
        color: #f36;
      }
      .scene-speaker.you {
        color: #0f8;
      }
      #scene-text {
        color: #ddd;
        line-height: 1.5;
        font-size: 13px;
        min-height: 40px;
      }
      #scene-input {
        display: none;
        margin-top: 10px;
      }
      #scene-input textarea {
        width: 100%;
        background: #0a0a12;
        border: 2px solid #0ff;
        color: #fff;
        padding: 10px;
        border-radius: 8px;
        font-size: 13px;
        min-height: 60px;
        resize: none;
      }
      #scene-input button {
        width: 100%;
        background: linear-gradient(135deg, #0ff, #0f8);
        color: #000;
        border: none;
        padding: 12px;
        font-family: "Orbitron";
        cursor: pointer;
        border-radius: 8px;
        margin-top: 8px;
      }
      #scene-options {
        display: none;
        margin-top: 10px;
      }
      .scene-option {
        background: #1a1a2e;
        border: 2px solid #2a2a4e;
        color: #aaa;
        padding: 10px;
        margin-bottom: 5px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 12px;
      }
      .scene-option:hover {
        border-color: #0ff;
        color: #0ff;
      }
      #scene-result {
        display: none;
        text-align: center;
        padding: 20px;
      }
      #scene-result h2 {
        font-family: "Orbitron";
        font-size: 24px;
        margin-bottom: 15px;
      }
      #scene-result p {
        color: #aaa;
        margin-bottom: 20px;
      }
      #scene-result button {
        background: linear-gradient(135deg, #0ff, #0f8);
        color: #000;
        border: none;
        padding: 12px 30px;
        font-family: "Orbitron";
        cursor: pointer;
        border-radius: 8px;
      }
      #client-chat {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.95);
        z-index: 650;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 15px;
      }
      #chat-box {
        background: #1a1a2e;
        border: 2px solid #0ff;
        border-radius: 15px;
        padding: 20px;
        max-width: 500px;
        width: 100%;
        max-height: 80vh;
        display: flex;
        flex-direction: column;
      }
      #chat-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }
      #chat-header h3 {
        color: #0ff;
        font-family: "Orbitron";
      }
      #chat-close {
        background: #f36;
        color: #fff;
        border: none;
        padding: 8px 15px;
        cursor: pointer;
        border-radius: 5px;
      }
      #chat-messages {
        flex: 1;
        overflow-y: auto;
        margin-bottom: 15px;
        max-height: 300px;
      }
      .chat-msg {
        padding: 10px;
        margin-bottom: 8px;
        border-radius: 8px;
        font-size: 13px;
      }
      .chat-msg.client {
        background: #2a2a4e;
        color: #fff;
        margin-right: 40px;
      }
      .chat-msg.you {
        background: #0a3a3a;
        color: #0ff;
        margin-left: 40px;
        text-align: right;
      }
      #chat-input {
        display: flex;
        gap: 10px;
      }
      #chat-input textarea {
        flex: 1;
        background: #0a0a12;
        border: 2px solid #0ff;
        color: #fff;
        padding: 10px;
        border-radius: 8px;
        resize: none;
        min-height: 50px;
      }
      #chat-input button {
        background: #0ff;
        color: #000;
        border: none;
        padding: 10px 20px;
        cursor: pointer;
        border-radius: 8px;
        font-family: "Orbitron";
      }
    </style>
  </head>
  <body>
    <div id="suspended" style="display: none">
      <h1>â›” ZAWIESZONY</h1>
      <p>Twoja licencja detektywa zostaÅ‚a zawieszona za bÅ‚Ä™dne wnioski.</p>
      <p>MoÅ¼esz wrÃ³ciÄ‡ za:</p>
      <div class="time" id="suspend-time">00:00:00</div>
      <p style="color: #666; font-size: 12px">Zamknij stronÄ™ i wrÃ³Ä‡ pÃ³Åºniej.</p>
    </div>
    <div id="loader">
      <svg
        id="loader-logo"
        viewBox="0 0 120 120"
        xmlns="http://www.w3.org/2000/svg"
      >
        <defs>
          <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color: #0ff" />
            <stop offset="100%" style="stop-color: #0f8" />
          </linearGradient>
        </defs>
        <rect fill="#0a0a12" width="120" height="120" rx="15" />
        <circle
          cx="45"
          cy="50"
          r="28"
          fill="none"
          stroke="url(#grad1)"
          stroke-width="5"
        />
        <line
          x1="66"
          y1="71"
          x2="95"
          y2="100"
          stroke="url(#grad1)"
          stroke-width="6"
          stroke-linecap="round"
        />
        <circle cx="85" cy="30" r="12" fill="#f36" />
        <text
          x="85"
          y="35"
          text-anchor="middle"
          fill="white"
          font-size="16"
          font-weight="bold"
        >
          !
        </text>
      </svg>
      <h1>CYBER DETECTIVE</h1>
      <div id="loader-percent">0%</div>
      <div id="loader-bar-container"><div id="loader-bar"></div></div>
      <div id="loader-text">Inicjalizacja...</div>
    </div>
    <div id="intro">
      <h1>CYBER DETECTIVE</h1>
      <p>Åšledczy ds. CyberprzestÄ™pczoÅ›ci</p>
      <div
        style="
          text-align: left;
          background: #1a1a2e;
          padding: 15px;
          border-radius: 10px;
          margin: 15px 0;
          max-height: 50vh;
          overflow-y: auto;
          font-size: 12px;
          line-height: 1.6;
        "
      >
        <h3 style="color: #0ff; margin-top: 0">ğŸ“‹ INSTRUKCJA GRY</h3>

        <p style="color: #fc0"><strong>ğŸ¯ CEL GRY:</strong></p>
        <p>
          JesteÅ› detektywem cyfrowym. Analizujesz dowody cyberprzestÄ™pstw i
          przedstawiasz sprawy w sÄ…dzie lub na policji. Zarabiasz pieniÄ…dze za
          poprawne wnioski, tracisz za bÅ‚Ä™dy!
        </p>

        <p style="color: #fc0"><strong>ğŸ¢ LOKALIZACJE W BIURZE:</strong></p>
        <p>
          â€¢ <strong>ğŸšª DRZWI</strong> - przyjmowanie nowych klientÃ³w<br />
          â€¢ <strong>ğŸ’» KOMPUTER</strong> - analiza dowodÃ³w i wysyÅ‚anie spraw<br />
          â€¢ <strong>ğŸ›’ SKLEP</strong> - kupowanie narzÄ™dzi forensycznych
        </p>

        <p style="color: #fc0">
          <strong>ğŸ”¬ ANALIZA DOWODÃ“W (przy komputerze):</strong>
        </p>
        <p>
          1. WejdÅº w zakÅ‚adkÄ™ <strong>ğŸ“ SPRAWY</strong><br />
          2. Wybierz sprawÄ™ i kliknij <strong>ğŸ” ANALIZUJ</strong><br />
          3. UÅ¼yj narzÄ™dzi do zbadania dowodu:<br />
          &nbsp;&nbsp;â€¢ <strong>ğŸ” Lupa</strong> - powiÄ™kszenie 2.5x
          (darmowa)<br />
          &nbsp;&nbsp;â€¢ <strong>ğŸ“Š Meta</strong> - metadane pliku (800ğŸ’°)<br />
          &nbsp;&nbsp;â€¢ <strong>âš¡ ELA</strong> - analiza bÅ‚Ä™dÃ³w kompresji
          (1500ğŸ’°)<br />
          &nbsp;&nbsp;â€¢ <strong>ğŸ”¤ Font</strong> - sprawdzenie czcionek
          (1000ğŸ’°)<br />
          &nbsp;&nbsp;â€¢ <strong>ğŸ• Czas</strong> - analiza znacznikÃ³w czasowych
          (1200ğŸ’°)<br />
          &nbsp;&nbsp;â€¢ <strong>ğŸ¤– AI</strong> - wykrywanie AI/deepfake
          (3000ğŸ’°)<br />
          4. Na podstawie wynikÃ³w zaznacz:
          <strong style="color: #f36">âŒ FAÅSZ</strong> lub
          <strong style="color: #0f8">âœ“ OK</strong>
        </p>

        <p style="color: #fc0"><strong>ğŸ“¤ WYSYÅANIE SPRAWY:</strong></p>
        <p>
          1. WejdÅº w zakÅ‚adkÄ™ <strong>ğŸ“¤ WYÅšLIJ</strong><br />
          2. Wybierz sprawÄ™ z listy<br />
          3. (Opcjonalnie) Kliknij <strong>ğŸ¤µ POÅšREDNIK</strong> - porada za
          50ğŸ’°<br />
          4. Wybierz instytucjÄ™:<br />
          &nbsp;&nbsp;â€¢ <strong>ğŸš” POLICJA</strong> - groÅºby, stalking,
          przemoc<br />
          &nbsp;&nbsp;â€¢ <strong>âš–ï¸ SÄ„D</strong> - zniesÅ‚awienie, oszustwa
          cywilne<br />
          5. Kliknij <strong>ğŸ“¤ WYÅšLIJ</strong>
        </p>

        <p style="color: #fc0"><strong>âš–ï¸ ROZPRAWA / PRZESÅUCHANIE:</strong></p>
        <p>
          Po wysÅ‚aniu sprawy trafisz do sÄ…du lub na policjÄ™. Musisz odpowiadaÄ‡
          na pytania!<br />
          â€¢ UÅ¼ywaj <strong>sÅ‚Ã³w kluczowych</strong> ze sprawy (imiona, miejsca,
          szczegÃ³Å‚y)<br />
          â€¢ Twoje zeznania muszÄ… byÄ‡ <strong>SPÃ“JNE</strong> z tym co
          zaznaczyÅ‚eÅ›!<br />
          â€¢ JeÅ›li zaznaczyÅ‚eÅ› FAÅSZ â†’ mÃ³w Å¼e dowÃ³d jest faÅ‚szywy<br />
          â€¢ JeÅ›li zaznaczyÅ‚eÅ› OK â†’ mÃ³w Å¼e dowÃ³d jest prawdziwy
        </p>

        <p style="color: #f36">
          <strong>âš ï¸ UWAGA - KLIENT MOÅ»E KÅAMAÄ†!</strong>
        </p>
        <p>
          NiektÃ³rzy klienci sami faÅ‚szujÄ… dowody Å¼eby wrobiÄ‡ niewinnych! JeÅ›li
          analiza wykaÅ¼e Å¼e to KLIENT sfaÅ‚szowaÅ‚ dowÃ³d - oskarÅ¼ JEGO w
          zeznaniach! (np. "klient kÅ‚amie", "klient sfaÅ‚szowaÅ‚")
        </p>

        <p style="color: #fc0">
          <strong>ğŸ’° SYSTEM OPÅAT ZA NARZÄ˜DZIA:</strong>
        </p>
        <p>
          KaÅ¼de kupione narzÄ™dzie pobiera
          <strong style="color: #f36">% z kaÅ¼dej wypÅ‚aty</strong>!<br />
          &nbsp;&nbsp;â€¢ ğŸ“Š Meta = <strong>5%</strong> z wypÅ‚at<br />
          &nbsp;&nbsp;â€¢ ğŸ”¤ Font = <strong>6%</strong> z wypÅ‚at<br />
          &nbsp;&nbsp;â€¢ ğŸ• Czas = <strong>8%</strong> z wypÅ‚at<br />
          &nbsp;&nbsp;â€¢ âš¡ ELA = <strong>10%</strong> z wypÅ‚at<br />
          &nbsp;&nbsp;â€¢ ğŸ¤– AI = <strong>15%</strong> z wypÅ‚at<br />
          Wszystkie narzÄ™dzia razem =
          <strong style="color: #f36">44% podatku!</strong><br />
          MoÅ¼esz <strong style="color: #0f8">sprzedaÄ‡</strong> narzÄ™dzie za 5%
          jego wartoÅ›ci Å¼eby pozbyÄ‡ siÄ™ opÅ‚aty.
        </p>

        <p style="color: #fc0"><strong>ğŸ’° NAGRODY I KARY:</strong></p>
        <p>
          â€¢ âœ… Poprawna analiza + dobre zeznania =
          <strong style="color: #0f8">+150% nagrody</strong><br />
          â€¢ âœ… Poprawna analiza =
          <strong style="color: #0f8">+100% nagrody</strong><br />
          â€¢ âš ï¸ SÅ‚abe zeznania =
          <strong style="color: #f90">+50% lub mniej</strong><br />
          â€¢ âŒ BÅ‚Ä™dna analiza = <strong style="color: #f36">GRZYWNA</strong
          ><br />
          â€¢ âŒ Sprzeczne zeznania = <strong style="color: #f36">GRZYWNA</strong
          ><br />
          â€¢ âŒ FaÅ‚szywe oskarÅ¼enie =
          <strong style="color: #f36">ZAWIESZENIE 2h!</strong>
        </p>

        <p style="color: #0ff"><strong>ğŸ’¡ WSKAZÃ“WKI:</strong></p>
        <p>
          â€¢ Czytaj uwaÅ¼nie historiÄ™ klienta - tam sÄ… wskazÃ³wki!<br />
          â€¢ SprawdÅº WSZYSTKIE narzÄ™dzia przed ocenÄ…<br />
          â€¢ PamiÄ™taj co zaznaczyÅ‚eÅ› - sÄ™dzia/policja o to zapyta!<br />
          â€¢ Nie spiesz siÄ™ - bÅ‚Ä™dy kosztujÄ…!
        </p>
      </div>
      <button id="start-btn">â–¶ ROZPOCZNIJ GRÄ˜</button>
    </div>
    <canvas id="canvas"></canvas>
    <div id="crosshair"></div>
    <div id="prompt"></div>
    <div id="touch-btn">ğŸ‘† WEJDÅ¹</div>
    <div id="hud">
      <div>ğŸ’° <span id="hud-credits">500</span></div>
      <div>ğŸ“‹ <span id="hud-cases">0</span></div>
      <div>ğŸ“… DzieÅ„ <span id="hud-day">1</span></div>
      <div style="color: #f90">ğŸ“‰ <span id="hud-tax">0%</span></div>
    </div>
    <div id="computer">
      <div id="computer-bar">
        <span>ğŸ–¥ï¸ TERMINAL</span><button id="exit-btn">âœ•</button>
      </div>
      <div id="computer-main">
        <div id="sidebar">
          <div class="nav-item active" data-panel="case">ğŸ“‹</div>
          <div class="nav-item" data-panel="send">ğŸ“¤</div>
          <div class="nav-item" data-panel="inbox">ğŸ“¬</div>
          <div class="nav-item" data-panel="shop">ğŸ›’</div>
          <div class="nav-item" data-panel="archive">ğŸ“</div>
        </div>
        <div id="content"></div>
      </div>
    </div>
    <div id="analysis">
      <div id="analysis-header">
        <h2>ğŸ”¬ ANALIZA</h2>
        <button id="close-analysis">âœ•</button>
      </div>
      <div id="analysis-body">
        <div id="img-viewer"><img id="analysis-img" src="" /></div>
        <div id="tools-panel"></div>
      </div>
    </div>
    <div id="visitor">
      <div id="visitor-box">
        <div class="visitor-head">
          <div class="visitor-avatar" id="v-avatar">ğŸ‘¤</div>
          <div>
            <h3 id="v-name" style="color: #fff">Klient</h3>
            <p style="color: #0f8">
              Bazowa opÅ‚ata: <span id="v-fee">100</span>ğŸ’°
            </p>
          </div>
        </div>
        <div id="visitor-complaint"></div>
        <p style="color: #f90; font-size: 12px">
          â° Termin: <span id="v-deadline">3</span> dni | Kara:
          <span id="v-penalty">200</span>ğŸ’° (staÅ‚a)
        </p>
        <div
          style="
            margin: 15px 0;
            padding: 10px;
            background: #1a1a2e;
            border-radius: 8px;
          "
        >
          <p style="color: #0ff; font-size: 12px; margin-bottom: 8px">
            ğŸ’° NEGOCJUJ CENÄ˜:
          </p>
          <div style="display: flex; gap: 10px; align-items: center">
            <input
              type="number"
              id="price-input"
              style="
                flex: 1;
                padding: 10px;
                background: #0a0a12;
                border: 1px solid #0ff;
                color: #fff;
                border-radius: 5px;
                font-size: 16px;
              "
              placeholder="Wpisz kwotÄ™..."
            /><span style="color: #fff">ğŸ’°</span>
          </div>
          <p
            id="price-response"
            style="
              color: #888;
              font-size: 11px;
              margin-top: 8px;
              font-style: italic;
            "
          ></p>
        </div>
        <div class="visitor-btns" style="margin-top: 15px">
          <button id="btn-accept">
            âœ“ PRZYJMIJ ZA <span id="agreed-price">100</span>ğŸ’°</button
          ><button id="btn-reject">âœ• ODRZUÄ†</button>
        </div>
      </div>
    </div>
    <div id="result">
      <div id="result-box">
        <div id="result-icon">âœ“</div>
        <h2 id="result-title">SUKCES!</h2>
        <p id="result-msg"></p>
        <p id="result-reward">+300ğŸ’°</p>
        <button id="continue-btn">DALEJ â†’</button>
      </div>
    </div>
    <div id="notif">
      <h4 id="notif-title">Info</h4>
      <p id="notif-msg">Msg</p>
    </div>
    <div
      id="client-chat"
      style="
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.95);
        z-index: 650;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 15px;
      "
    >
      <div
        style="
          background: #1a1a2e;
          border: 2px solid #0ff;
          border-radius: 15px;
          padding: 20px;
          max-width: 500px;
          width: 100%;
          max-height: 80vh;
          overflow-y: auto;
        "
      >
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
          "
        >
          <h3 style="color: #0ff; font-family: Orbitron" id="chat-client-name">
            ğŸ’¬ Klient
          </h3>
          <button
            id="close-chat"
            style="
              background: #f36;
              color: #fff;
              border: none;
              padding: 5px 12px;
              border-radius: 5px;
              cursor: pointer;
            "
          >
            âœ•
          </button>
        </div>
        <div
          id="chat-messages"
          style="
            background: #0a0a12;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
            min-height: 150px;
            max-height: 300px;
            overflow-y: auto;
          "
        ></div>
        <textarea
          id="chat-input"
          placeholder="Napisz do klienta..."
          style="
            width: 100%;
            background: #0a0a12;
            border: 2px solid #2a2a4e;
            color: #fff;
            padding: 10px;
            border-radius: 8px;
            min-height: 60px;
            resize: none;
            margin-bottom: 10px;
          "
        ></textarea>
        <button
          id="chat-send"
          style="
            width: 100%;
            background: linear-gradient(135deg, #0ff, #0f8);
            color: #000;
            border: none;
            padding: 12px;
            font-family: Orbitron;
            cursor: pointer;
            border-radius: 8px;
          "
        >
          ğŸ“¤ WYÅšLIJ
        </button>
      </div>
    </div>
    <div
      id="mediator-chat"
      style="
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.95);
        z-index: 650;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 15px;
      "
    >
      <div
        style="
          background: #1a1a2e;
          border: 2px solid #fc0;
          border-radius: 15px;
          padding: 20px;
          max-width: 500px;
          width: 100%;
          max-height: 80vh;
          overflow-y: auto;
        "
      >
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
          "
        >
          <h3 style="color: #fc0; font-family: Orbitron">ğŸ¤µ POÅšREDNIK</h3>
          <button
            id="close-mediator"
            style="
              background: #f36;
              color: #fff;
              border: none;
              padding: 5px 12px;
              border-radius: 5px;
              cursor: pointer;
            "
          >
            âœ•
          </button>
        </div>
        <p style="color: #888; font-size: 12px; margin-bottom: 10px">
          Rozmowa za darmo | Porada: <span style="color: #fc0">50ğŸ’°</span>
        </p>
        <div
          id="mediator-messages"
          style="
            background: #0a0a12;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
            min-height: 150px;
            max-height: 300px;
            overflow-y: auto;
          "
        ></div>
        <textarea
          id="mediator-input"
          placeholder="Opisz sprawÄ™ poÅ›rednikowi..."
          style="
            width: 100%;
            background: #0a0a12;
            border: 2px solid #2a2a4e;
            color: #fff;
            padding: 10px;
            border-radius: 8px;
            min-height: 60px;
            resize: none;
            margin-bottom: 10px;
          "
        ></textarea>
        <button
          id="mediator-send"
          style="
            width: 100%;
            background: linear-gradient(135deg, #fc0, #f90);
            color: #000;
            border: none;
            padding: 12px;
            font-family: Orbitron;
            cursor: pointer;
            border-radius: 8px;
          "
        >
          ğŸ“¤ WYÅšLIJ
        </button>
      </div>
    </div>
    <div id="scene-overlay">
      <canvas id="scene-canvas"></canvas>
      <div id="scene-ui">
        <div id="scene-dialogue">
          <div class="scene-speaker" id="scene-speaker">âš–ï¸ SÄ˜DZIA</div>
          <div id="scene-text">...</div>
        </div>
        <div id="scene-input">
          <textarea
            id="scene-textarea"
            placeholder="Twoja odpowiedÅº..."
          ></textarea>
          <button id="scene-submit">ğŸ“¢ ODPOWIEDZ</button>
        </div>
        <div id="scene-options"></div>
        <div id="scene-result">
          <h2 id="scene-verdict-title">WYROK</h2>
          <p id="scene-verdict-text"></p>
          <button id="scene-exit">ZAKOÅƒCZ</button>
        </div>
      </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
      var G = {
        credits: 500,
        day: 1,
        activeCases: [],
        selectedCase: null,
        inPC: false,
        tools: {
          zoom: true,
          meta: false,
          ela: false,
          font: false,
          time: false,
          ai: false,
        },
        results: {},
        completed: [],
        inbox: [],
        suspendedUntil: 0,
      };
      var sceneData = { type: null, caseData: null, correct: false, phase: 0 };
      var sceneScene,
        sceneCamera,
        sceneRenderer,
        sceneRotY = 0,
        sceneRotX = 0;
      var TOOLS = {
        zoom: { n: "ğŸ” Lupa", p: 0, tax: 0 },
        meta: { n: "ğŸ“Š Meta", p: 800, tax: 5 },
        ela: { n: "âš¡ ELA", p: 1500, tax: 10 },
        font: { n: "ğŸ”¤ Font", p: 1000, tax: 6 },
        time: { n: "ğŸ• Czas", p: 1200, tax: 8 },
        ai: { n: "ğŸ¤– AI", p: 3000, tax: 15 },
      };
      function getTotalTax() {
        var t = 0;
        for (var k in TOOLS) {
          if (G.tools[k] && TOOLS[k].tax) t += TOOLS[k].tax;
        }
        return t;
      }
      function sellTool(k) {
        if (!G.tools[k] || k == "zoom") return;
        var refund = Math.floor(TOOLS[k].p * 0.05);
        G.credits += refund;
        G.tools[k] = false;
        saveGame();
        updateHUD();
        notify("Sprzedano!", TOOLS[k].n + " +" + refund + "ğŸ’°");
      }
      var CASES = [
        {
          id: 1,
          name: "Anna Nowak",
          avatar: "ğŸ‘©",
          fee: 100,
          days: 3,
          pen: 200,
          rew: 400,
          fine: 200,
          type: "ZNIESÅAWIENIE",
          complaint: "FaÅ‚szywe screeny Messenger",
          clientLies: false,
          fullStory:
            "ProwadzÄ™ sklep internetowy od 5 lat. TydzieÅ„ temu na Facebooku pojawiÅ‚y siÄ™ screeny z Messengera gdzie niby przyznajÄ™ siÄ™ do oszukiwania klientÃ³w na wadze produktÃ³w. Problem w tym Å¼e NIGDY czegoÅ› takiego nie napisaÅ‚am! StraciÅ‚am juÅ¼ 15 klientÃ³w, ludzie piszÄ… Å¼e jestem oszustkÄ…. Mam podejrzenia kto to zrobiÅ‚ - moja byÅ‚a pracownica Kasia, ktÃ³rÄ… zwolniÅ‚am miesiÄ…c temu. ProszÄ™ o pomoc, to rujnuje mÃ³j biznes!",
          keywords: [
            "sklep",
            "kasia",
            "pracownic",
            "zwolni",
            "messenger",
            "waga",
            "klient",
            "oszuk",
            "facebook",
            "screen",
          ],
          suspect: "Kasia - byÅ‚a pracownica",
          evidence: [
            {
              id: "e1",
              tp: "MESSENGER",
              fake: true,
              txt: "Tak haha oszukujemy klientÃ³w na wadze ğŸ˜‚ Nikt siÄ™ nie kapnie!",
              ind: {
                meta: { s: 1, i: "Photoshop CC 2024 - plik edytowany" },
                ela: { s: 1, i: "Widoczne Å›lady manipulacji przy tekÅ›cie" },
                font: { s: 1, i: "Czcionka nie pasuje do Messengera" },
                time: { s: 1, i: "03:47 - klientka spaÅ‚a o tej porze" },
                ai: { s: 1, i: "94% prawdopodobieÅ„stwo manipulacji" },
              },
            },
          ],
        },
        {
          id: 2,
          name: "Marek WiÅ›niewski",
          avatar: "ğŸ‘¨â€ğŸ’¼",
          fee: 150,
          days: 4,
          pen: 300,
          rew: 500,
          fine: 250,
          type: "GROÅ¹BY",
          complaint: "GroÅºby od byÅ‚ego wspÃ³lnika",
          clientLies: false,
          fullStory:
            'ByÅ‚em wspÃ³lnikiem w firmie IT z Tomkiem K. RozstaliÅ›my siÄ™ w zÅ‚ych stosunkach - oskarÅ¼aÅ‚ mnie o kradzieÅ¼ kodu. Od 2 tygodni dostajÄ™ maile z groÅºbami. Pisze Å¼e "zniszczy mnie i mojÄ… rodzinÄ™", "wie gdzie mieszkam", "poÅ¼aÅ‚ujÄ™". BojÄ™ siÄ™ o Å¼onÄ™ i dzieci. ZgÅ‚osiÅ‚em juÅ¼ na policjÄ™ ale powiedzieli Å¼e potrzebujÄ… dowodÃ³w Å¼e to on. Maile przychodzÄ… z anonimowego adresu ale styl pisania to NA PEWNO Tomek.',
          keywords: [
            "tomek",
            "wspÃ³lnik",
            "firma",
            "it",
            "kod",
            "mail",
            "groÅºb",
            "rodzin",
            "Å¼on",
            "dzieci",
            "anonimow",
          ],
          suspect: "Tomek K. - byÅ‚y wspÃ³lnik",
          evidence: [
            {
              id: "e2",
              tp: "EMAIL",
              fake: false,
              txt: "ZniszczÄ™ ciÄ™ i twojÄ… rodzinÄ™. Wiem gdzie mieszkasz. Wiem gdzie chodzi twÃ³j syn do szkoÅ‚y. PoÅ¼aÅ‚ujesz Å¼e siÄ™ ze mnÄ… zadzieraÅ‚eÅ›.",
              ind: {
                meta: { s: 0, i: "NagÅ‚Ã³wek email oryginalny - serwer Gmail" },
                ela: { s: 0, i: "Brak Å›ladÃ³w edycji" },
                font: { s: 0, i: "Standardowa czcionka email" },
                time: { s: 0, i: "Znaczniki czasowe spÃ³jne" },
                ai: { s: 0, i: "6% - wiadomoÅ›Ä‡ autentyczna" },
              },
            },
          ],
        },
        {
          id: 3,
          name: "Katarzyna D.",
          avatar: "ğŸ‘©â€ğŸ¦°",
          fee: 80,
          days: 2,
          pen: 150,
          rew: 350,
          fine: 175,
          type: "STALKING",
          complaint: "ByÅ‚y partner mnie Å›ledzi",
          clientLies: false,
          fullStory:
            'RozstaÅ‚am siÄ™ z MichaÅ‚em 3 miesiÄ…ce temu. Od tamtej pory non stop dostaje wiadomoÅ›ci Å¼e mnie widziaÅ‚ - w kawiarni, w pracy, w sklepie. Pisze dokÅ‚adnie w co byÅ‚am ubrana, z kim rozmawiaÅ‚am. Wczoraj napisaÅ‚ Å¼e "Å‚adnie mi w tej niebieskiej sukience" - a byÅ‚am w niej tylko 2 godziny! BojÄ™ siÄ™ wychodziÄ‡ z domu. Mam screeny z WhatsApp. ProszÄ™ o pomoc, czujÄ™ siÄ™ obserwowana 24/7.',
          keywords: [
            "michaÅ‚",
            "partner",
            "whatsapp",
            "Å›ledzi",
            "obserwu",
            "sukienk",
            "kawiarni",
            "ubran",
            "wiadomo",
            "boi",
          ],
          suspect: "MichaÅ‚ - byÅ‚y partner",
          evidence: [
            {
              id: "e3",
              tp: "WHATSAPP",
              fake: false,
              txt: "WidziaÅ‚em ciÄ™ dziÅ› w Starbucks o 14:30. Åadna ta niebieska sukienka. Kawa z koleÅ¼ankÄ…? Ta blondynka to Ania z pracy?",
              ind: {
                meta: { s: 0, i: "Oryginalny backup WhatsApp - iPhone" },
                ela: { s: 0, i: "Zrzut niemodyfikowany" },
                font: { s: 0, i: "Czcionka WhatsApp prawidÅ‚owa" },
                time: { s: 0, i: "Znaczniki spÃ³jne z datÄ…" },
                ai: { s: 0, i: "4% - wiadomoÅ›Ä‡ autentyczna" },
              },
            },
          ],
        },
        {
          id: 4,
          name: "Piotr Lewandowski",
          avatar: "ğŸ‘¨â€ğŸ’»",
          fee: 120,
          days: 3,
          pen: 250,
          rew: 450,
          fine: 225,
          type: "PODSZYWANIE",
          complaint: "FaÅ‚szywe konto z rasizmem",
          clientLies: false,
          fullStory:
            "Jestem programistÄ…, aktywnym na Twitterze/X. KtoÅ› stworzyÅ‚ konto @PiotrLew_PRAWDA i publikuje rasistowskie i antysemickie treÅ›ci. UÅ¼ywa mojego zdjÄ™cia i nazwiska! Moi klienci myÅ›lÄ… Å¼e to ja. StraciÅ‚em juÅ¼ 2 kontrakty. Twitter nie reaguje na zgÅ‚oszenia. Mam screeny tych postÃ³w. Podejrzewam konkurencjÄ™ - firmÄ™ DataSoft, z ktÃ³rÄ… walczyÅ‚em o duÅ¼y kontrakt.",
          keywords: [
            "programist",
            "twitter",
            "datasoft",
            "konkurencj",
            "konto",
            "rasist",
            "zdjÄ™ci",
            "kontrakt",
            "podszywa",
            "faÅ‚szyw",
          ],
          suspect: "Firma DataSoft - konkurencja",
          evidence: [
            {
              id: "e4",
              tp: "TWITTER",
              fake: true,
              txt: "Imigranci won z Polski! Polska dla prawdziwych PolakÃ³w! ğŸ‡µğŸ‡± #wyp****ol",
              ind: {
                meta: { s: 1, i: "Zrzut edytowany - Photoshop" },
                ela: { s: 1, i: "Avatar wklejony z innego ÅºrÃ³dÅ‚a" },
                font: { s: 1, i: "Czcionka nie pasuje do X/Twitter" },
                time: { s: 0, i: "Data publikacji moÅ¼liwa" },
                ai: { s: 1, i: "91% - profil sfabrykowany" },
              },
            },
          ],
        },
        {
          id: 5,
          name: "Ewa KamiÅ„ska",
          avatar: "ğŸ‘©â€ğŸ’¼",
          fee: 200,
          days: 3,
          pen: 400,
          rew: 600,
          fine: 300,
          type: "OSZUSTWO",
          complaint: "WyÅ‚udzenie na faÅ‚szywÄ… zbiÃ³rkÄ™",
          clientLies: false,
          fullStory:
            'WpÅ‚aciÅ‚am 5000 zÅ‚ na zbiÃ³rkÄ™ "Pomoc dla chorego Jasia" na Facebooku. ZbiÃ³rka wyglÄ…daÅ‚a wiarygodnie - zdjÄ™cia dziecka w szpitalu, dokumenty. Po wpÅ‚acie profil zniknÄ…Å‚! NapisaÅ‚am do szpitala ktÃ³ry byÅ‚ podany - powiedzieli Å¼e nie majÄ… takiego pacjenta. Mam screeny zbiÃ³rki i potwierdzenie przelewu. ProszÄ™ o pomoc w znalezieniu oszusta!',
          keywords: [
            "zbiÃ³rk",
            "5000",
            "jasio",
            "szpital",
            "facebook",
            "przelew",
            "profil",
            "zniknÄ…Å‚",
            "oszust",
            "chory",
          ],
          suspect: "Nieznany - faÅ‚szywa zbiÃ³rka",
          evidence: [
            {
              id: "e5",
              tp: "FACEBOOK",
              fake: false,
              txt: "ZbiÃ³rka: Pomoc dla chorego Jasia â¤ï¸ Cel: 50000 zÅ‚. Jasio ma 5 lat i walczy z biaÅ‚aczkÄ…...",
              ind: {
                meta: { s: 0, i: "Zrzut oryginalny - Chrome" },
                ela: { s: 0, i: "Bez edycji" },
                font: { s: 0, i: "Czcionka FB prawidÅ‚owa" },
                time: { s: 0, i: "Data spÃ³jna" },
                ai: {
                  s: 0,
                  i: "3% - zrzut autentyczny (ale zbiÃ³rka faÅ‚szywa)",
                },
              },
            },
          ],
        },
        {
          id: 6,
          name: "Tomasz Kowalczyk",
          avatar: "ğŸ‘¨",
          fee: 90,
          days: 2,
          pen: 180,
          rew: 380,
          fine: 190,
          type: "GROÅ¹BY",
          complaint: "GroÅºby przez SMS",
          clientLies: false,
          fullStory:
            "Od tygodnia dostajÄ™ SMS-y z nieznanego numeru. GroÅ¼Ä… Å¼e mnie zabijÄ…, Å¼e wiedzÄ… gdzie pracujÄ™. Podejrzewam Å¼e to przez konflikt z sÄ…siadem - pokÅ‚Ã³ciliÅ›my siÄ™ o miejsce parkingowe. On to typ agresywny, juÅ¼ raz miaÅ‚ sprawÄ™ o pobicie. Numer jest na kartÄ™ wiÄ™c nie wiem jak udowodniÄ‡ Å¼e to on.",
          keywords: [
            "sms",
            "sÄ…siad",
            "parking",
            "pobici",
            "numer",
            "karta",
            "groÅºb",
            "zabij",
            "praca",
            "konflikt",
          ],
          suspect: "SÄ…siad - konflikt o parking",
          evidence: [
            {
              id: "e6",
              tp: "SMS",
              fake: false,
              txt: "ZabijÄ™ ciÄ™ i caÅ‚Ä… twojÄ… rodzinÄ™ s********u. Wiem gdzie pracujesz. UwaÅ¼aj jak wychodzisz z roboty.",
              ind: {
                meta: { s: 0, i: "Zrzut Samsung - oryginalny" },
                ela: { s: 0, i: "Brak modyfikacji" },
                font: { s: 0, i: "Systemowa czcionka SMS" },
                time: { s: 0, i: "Daty wiadomoÅ›ci spÃ³jne" },
                ai: { s: 0, i: "5% - wiadomoÅ›ci autentyczne" },
              },
            },
          ],
        },
        {
          id: 7,
          name: "Magdalena ZieliÅ„ska",
          avatar: "ğŸ‘©â€ğŸ”¬",
          fee: 180,
          days: 4,
          pen: 350,
          rew: 550,
          fine: 275,
          type: "ZNIESÅAWIENIE",
          complaint: "FaÅ‚szywy post o plagiacie",
          clientLies: false,
          fullStory:
            'Jestem doktorantkÄ… na Politechnice. Na forum naukowym pojawiÅ‚ siÄ™ post gdzie rzekomo przyznajÄ™ siÄ™ do plagiatu w pracy doktorskiej. Screenshot z Messengera gdzie piszÄ™ "skopiowaÅ‚am 70% pracy, system antyplagiatowy tego nie wykryÅ‚". To NIEPRAWDA! Moja promotorka juÅ¼ ma wÄ…tpliwoÅ›ci. Podejrzewam zazdrosnÄ… koleÅ¼ankÄ™ AnetÄ™ ktÃ³ra teÅ¼ pisze doktorat z tego tematu.',
          keywords: [
            "doktorant",
            "politechnik",
            "plagiat",
            "aneta",
            "koleÅ¼ank",
            "forum",
            "70%",
            "promotor",
            "praca",
            "screenshot",
          ],
          suspect: "Aneta - zazdrosna koleÅ¼anka",
          evidence: [
            {
              id: "e7",
              tp: "FORUM POST",
              fake: true,
              txt: 'Screenshot rozmowy dr ZieliÅ„skiej: "Tak, skopiowaÅ‚am 70% pracy doktorskiej lol. System tego nie wykryÅ‚ ğŸ˜‚"',
              ind: {
                meta: { s: 1, i: "Obraz edytowany - Canva" },
                ela: { s: 1, i: "Tekst wstawiony cyfrowo" },
                font: { s: 1, i: "Font nie pasuje do Messengera" },
                time: { s: 1, i: "Konto na forum zaÅ‚oÅ¼one dzieÅ„ przed postem" },
                ai: { s: 1, i: "89% - screenshot sfabrykowany" },
              },
            },
          ],
        },
        {
          id: 8,
          name: "Robert Adamski",
          avatar: "ğŸ‘¨â€ğŸ¦²",
          fee: 250,
          days: 5,
          pen: 500,
          rew: 700,
          fine: 350,
          type: "HACKING",
          complaint: "WÅ‚amanie na konto bankowe",
          clientLies: false,
          fullStory:
            'W zeszÅ‚ym tygodniu ktoÅ› wÅ‚amaÅ‚ siÄ™ na moje konto w banku i przelaÅ‚ 12000 zÅ‚ na zagraniczne konto. Bank mÃ³wi Å¼e logowanie byÅ‚o z mojego urzÄ…dzenia ale to niemoÅ¼liwe - byÅ‚em w pracy! Podejrzewam phishing - tydzieÅ„ wczeÅ›niej dostaÅ‚em dziwny mail "z banku". GÅ‚upio kliknÄ…Å‚em w link i wpisaÅ‚em dane. Mam ten mail zapisany.',
          keywords: [
            "bank",
            "12000",
            "phishing",
            "mail",
            "link",
            "wÅ‚aman",
            "przelew",
            "zagranic",
            "dane",
            "konto",
          ],
          suspect: "Nieznany haker - phishing",
          evidence: [
            {
              id: "e8",
              tp: "EMAIL PHISHING",
              fake: false,
              txt: "Szanowny Kliencie! WykryliÅ›my podejrzanÄ… aktywnoÅ›Ä‡. Kliknij aby zweryfikowaÄ‡: bank-weryfikacja.tk/login",
              ind: {
                meta: { s: 0, i: "Mail prawdziwy - nagÅ‚Ã³wki potwierdzone" },
                ela: { s: 0, i: "Oryginalny mail phishingowy" },
                font: { s: 0, i: "PrÃ³ba imitacji banku" },
                time: { s: 0, i: "WysÅ‚any z serwera w Rosji" },
                ai: { s: 0, i: "2% - autentyczny mail phishingowy" },
              },
            },
          ],
        },
        {
          id: 9,
          name: "Alicja Pawlak",
          avatar: "ğŸ‘§",
          fee: 60,
          days: 2,
          pen: 120,
          rew: 300,
          fine: 150,
          type: "GROÅ¹BY",
          complaint: "Cyberprzemoc w szkole",
          clientLies: false,
          fullStory:
            'Moja cÃ³rka Zuzia (13 lat) wraca ze szkoÅ‚y z pÅ‚aczem. Na Snapchacie grupa "Zuzia to ofiara" gdzie koleÅ¼anki z klasy piszÄ… okropne rzeczy - Å¼e jest brzydka, Å¼e nikt jej nie lubi, Å¼e powinna "zniknÄ…Ä‡". Wczoraj byÅ‚o "jutro dostaniesz w twarz". Zuzia nie chce iÅ›Ä‡ do szkoÅ‚y. Dyrekcja mÃ³wi Å¼e "nie mogÄ… nic zrobiÄ‡ bo to poza szkoÅ‚Ä…". Mam screeny z jej telefonu.',
          keywords: [
            "zuzia",
            "cÃ³rka",
            "szkoÅ‚a",
            "snapchat",
            "grupa",
            "koleÅ¼ank",
            "brzydka",
            "przemoc",
            "13 lat",
            "dyrekcj",
          ],
          suspect: "KoleÅ¼anki z klasy",
          evidence: [
            {
              id: "e9",
              tp: "SNAPCHAT",
              fake: false,
              txt: 'Grupa "Zuzia to ofiara": "JesteÅ› taka brzydka ğŸ¤® Nikt ciÄ™ nie lubi. Jutro dostaniesz w twarz loserko!!!"',
              ind: {
                meta: { s: 0, i: "Screenshot Snapchat - oryginalny" },
                ela: { s: 0, i: "Bez edycji" },
                font: { s: 0, i: "Czcionka Snapchat OK" },
                time: { s: 0, i: "Data spÃ³jna" },
                ai: { s: 0, i: "3% - wiadomoÅ›ci autentyczne" },
              },
            },
          ],
        },
        {
          id: 10,
          name: "Krzysztof Nowicki",
          avatar: "ğŸ‘¨â€ğŸ’¼",
          fee: 300,
          days: 5,
          pen: 600,
          rew: 800,
          fine: 400,
          type: "SZANTAÅ»",
          complaint: "SzantaÅ¼ intymnymi zdjÄ™ciami",
          clientLies: false,
          fullStory:
            "PoznaÅ‚em kogoÅ› na Tinderze, wymieniliÅ›my kilka zdjÄ™Ä‡... w tym intymne. Teraz ta osoba grozi Å¼e wyÅ›le je do mojej Å¼ony i do pracy jeÅ›li nie zapÅ‚acÄ™ 10000 zÅ‚. Mam rodzinÄ™, dobrÄ… pracÄ™ w korporacji - to by mnie zniszczyÅ‚o. Wiem Å¼e to moja gÅ‚upota ale proszÄ™ o pomoc. Osoba pisze z anonimowego maila przez Protonmail.",
          keywords: [
            "tinder",
            "zdjÄ™ci",
            "intymn",
            "Å¼ona",
            "praca",
            "10000",
            "szantaÅ¼",
            "protonmail",
            "anonimow",
            "bitcoin",
            "btc",
          ],
          suspect: "Nieznany - szantaÅ¼ysta z Tindera",
          evidence: [
            {
              id: "e10",
              tp: "EMAIL",
              fake: false,
              txt: "Mam twoje zdjÄ™cia. Wiem gdzie pracujesz - [nazwa firmy]. Mam FB twojej Å¼ony. 10000 zÅ‚ na BTC albo wszyscy zobaczÄ….",
              ind: {
                meta: { s: 0, i: "Email przez Protonmail - anonimowy" },
                ela: { s: 0, i: "Oryginalny email" },
                font: { s: 0, i: "Standardowy format" },
                time: { s: 0, i: "WysÅ‚any przez sieÄ‡ TOR" },
                ai: { s: 0, i: "4% - prawdziwy szantaÅ¼" },
              },
            },
          ],
        },
        {
          id: 11,
          name: "Damian Krawczyk",
          avatar: "ğŸ‘¨â€ğŸ¦±",
          fee: 180,
          days: 3,
          pen: 350,
          rew: 500,
          fine: 400,
          type: "ZNIESÅAWIENIE",
          complaint: "ByÅ‚y pracodawca mnie oczernia",
          clientLies: true,
          fullStory:
            "MÃ³j byÅ‚y szef Janusz z firmy BudMal pisze o mnie kÅ‚amstwa na forach budowlanych! Twierdzi Å¼e kradÅ‚em materiaÅ‚y i oszukiwaÅ‚em klientÃ³w. To NIEPRAWDA! Przez niego nie mogÄ™ znaleÅºÄ‡ pracy w branÅ¼y. Mam screeny jego postÃ³w. ChcÄ™ go pozwaÄ‡!",
          keywords: [
            "janusz",
            "budmal",
            "szef",
            "forum",
            "kradÅ‚",
            "materiaÅ‚",
            "praca",
            "branÅ¼",
            "post",
          ],
          suspect: "Janusz - byÅ‚y szef",
          evidence: [
            {
              id: "e11",
              tp: "FORUM",
              fake: true,
              txt: "UWAGA na Damiana K.! PracowaÅ‚ u mnie i kradÅ‚ materiaÅ‚y budowlane. OszukiwaÅ‚ teÅ¼ klientÃ³w na metraÅ¼u. Nie zatrudniajcie!",
              ind: {
                meta: { s: 1, i: "Screenshot edytowany - Paint.NET" },
                ela: { s: 1, i: "Tekst wklejony cyfrowo" },
                font: { s: 1, i: "Font nie pasuje do forum" },
                time: {
                  s: 1,
                  i: "Post datowany na dzieÅ„ wolny - forum zamkniÄ™te",
                },
                ai: { s: 1, i: "92% - screenshot sfabrykowany przez KLIENTA" },
              },
            },
          ],
        },
        {
          id: 12,
          name: "Natalia WoÅºniak",
          avatar: "ğŸ‘©â€ğŸ¤",
          fee: 150,
          days: 3,
          pen: 300,
          rew: 450,
          fine: 350,
          type: "GROÅ¹BY",
          complaint: "Stalker grozi mi Å›mierciÄ…",
          clientLies: true,
          fullStory:
            "Jestem influencerkÄ… na Instagramie. Od miesiÄ…ca dostajÄ™ wiadomoÅ›ci od stalkera ktÃ³ry grozi Å¼e mnie zabije! Pisze z anonimowego konta. BojÄ™ siÄ™ wychodziÄ‡ z domu. Mam screeny tych wiadomoÅ›ci. ProszÄ™ o pomoc!",
          keywords: [
            "instagram",
            "stalker",
            "grozi",
            "anonimow",
            "wiadomo",
            "influencer",
            "zabij",
            "konto",
            "dm",
          ],
          suspect: "Anonimowy stalker",
          evidence: [
            {
              id: "e12",
              tp: "INSTAGRAM DM",
              fake: true,
              txt: "Wiem gdzie mieszkasz s**o. ObserwujÄ™ ciÄ™ codziennie. NiedÅ‚ugo ciÄ™ dorwÄ™ i zabijÄ™!!! ğŸ”ª",
              ind: {
                meta: { s: 1, i: "Screenshot utworzony w Photoshop" },
                ela: { s: 1, i: "Interfejs IG niezgodny z wersjÄ…" },
                font: { s: 1, i: "Czcionka nie pasuje do Instagram" },
                time: { s: 1, i: "Timestamp niemoÅ¼liwy - format bÅ‚Ä™dny" },
                ai: { s: 1, i: "96% - KLIENTKA sama stworzyÅ‚a te screeny" },
              },
            },
          ],
        },
        {
          id: 13,
          name: "Bartosz Maj",
          avatar: "ğŸ‘¨â€ğŸ’»",
          fee: 200,
          days: 4,
          pen: 400,
          rew: 550,
          fine: 450,
          type: "HACKING",
          complaint: "KtoÅ› wÅ‚amaÅ‚ siÄ™ na moje konto",
          clientLies: true,
          fullStory:
            "KtoÅ› wÅ‚amaÅ‚ siÄ™ na moje konto bankowe i zrobiÅ‚ przelew na 8000 zÅ‚! Bank nie chce oddaÄ‡ pieniÄ™dzy bo mÃ³wiÄ… Å¼e logowanie byÅ‚o z mojego IP. Ale ja nie robiÅ‚em tego przelewu! Mam potwierdzenie z banku. To musiaÅ‚ byÄ‡ haker!",
          keywords: [
            "bank",
            "8000",
            "przelew",
            "ip",
            "wÅ‚aman",
            "haker",
            "konto",
            "logowani",
            "pieniÄ…d",
          ],
          suspect: "Nieznany haker",
          evidence: [
            {
              id: "e13",
              tp: "POTWIERDZENIE PRZELEWU",
              fake: false,
              txt: 'Przelew: 8000 zÅ‚ | Odbiorca: Konto Bartosza M. (drugie konto) | TytuÅ‚: "zwrot"',
              ind: {
                meta: { s: 0, i: "Dokument oryginalny z banku" },
                ela: { s: 0, i: "Brak edycji" },
                font: { s: 0, i: "Oficjalny format bankowy" },
                time: { s: 0, i: "Data i godzina spÃ³jne" },
                ai: {
                  s: 0,
                  i: "2% - KLIENT sam przelaÅ‚ na swoje drugie konto!",
                },
              },
            },
          ],
        },
      ];
      function speak(text, voice) {
        if (!("speechSynthesis" in window)) return;
        var u = new SpeechSynthesisUtterance(text);
        u.lang = "pl-PL";
        u.rate = 0.9;
        if (voice == "judge") {
          u.pitch = 0.8;
          u.rate = 0.85;
        } else if (voice == "defense") {
          u.pitch = 1.1;
          u.rate = 1.0;
        } else if (voice == "police") {
          u.pitch = 0.9;
          u.rate = 0.95;
        }
        speechSynthesis.speak(u);
      }
      function genImg(e) {
        var c = document.createElement("canvas");
        c.width = 300;
        c.height = 150;
        var x = c.getContext("2d");
        x.fillStyle = "#1a1a2e";
        x.fillRect(0, 0, 300, 150);
        x.fillStyle = "#0ff";
        x.font = "bold 11px Arial";
        x.fillText(e.tp, 10, 18);
        x.fillStyle = "#fff";
        x.font = "11px Arial";
        var w = e.txt.split(" "),
          l = "",
          y = 40;
        for (var i = 0; i < w.length; i++) {
          if ((l + w[i]).length > 38) {
            x.fillText(l, 10, y);
            y += 14;
            l = "";
          }
          l += w[i] + " ";
        }
        x.fillText(l, 10, y);
        return c.toDataURL();
      }
      function saveGame() {
        try {
          localStorage.setItem(
            "cyberdetective",
            JSON.stringify({
              credits: G.credits,
              day: G.day,
              tools: G.tools,
              completed: G.completed,
              inbox: G.inbox,
              suspendedUntil: G.suspendedUntil,
              activeCases: G.activeCases,
              selectedCase: G.selectedCase,
              results: G.results,
            })
          );
        } catch (e) {
          console.log("Save error", e);
        }
      }
      function loadGame() {
        try {
          var s = localStorage.getItem("cyberdetective");
          if (s) {
            var d = JSON.parse(s);
            G.credits = d.credits !== undefined ? d.credits : 500;
            G.day = d.day || 1;
            G.tools = d.tools || {
              zoom: true,
              meta: false,
              ela: false,
              font: false,
              time: false,
              ai: false,
            };
            G.completed = d.completed || [];
            G.inbox = d.inbox || [];
            G.suspendedUntil = d.suspendedUntil || 0;
            G.activeCases = d.activeCases || [];
            G.selectedCase =
              d.selectedCase !== undefined ? d.selectedCase : null;
            G.results = d.results || {};
            for (var i = 0; i < G.activeCases.length; i++) {
              for (var j = 0; j < G.activeCases[i].evidence.length; j++) {
                G.activeCases[i].evidence[j].img = genImg(
                  G.activeCases[i].evidence[j]
                );
              }
            }
            return true;
          }
        } catch (e) {
          console.log("Load error", e);
        }
        return false;
      }
      function checkSuspension() {
        if (G.suspendedUntil > Date.now()) {
          document.getElementById("loader").style.display = "none";
          document.getElementById("suspended").style.display = "flex";
          updateSuspendTimer();
          return true;
        }
        return false;
      }
      function updateSuspendTimer() {
        var left = G.suspendedUntil - Date.now();
        if (left <= 0) {
          G.suspendedUntil = 0;
          saveGame();
          location.reload();
          return;
        }
        var h = Math.floor(left / 3600000);
        var m = Math.floor((left % 3600000) / 60000);
        var s = Math.floor((left % 60000) / 1000);
        document.getElementById("suspend-time").textContent =
          (h < 10 ? "0" : "") +
          h +
          ":" +
          (m < 10 ? "0" : "") +
          m +
          ":" +
          (s < 10 ? "0" : "") +
          s;
        setTimeout(updateSuspendTimer, 1000);
      }
      function suspendPlayer(hours) {
        G.suspendedUntil = Date.now() + hours * 3600000;
        saveGame();
        document.getElementById("scene-overlay").style.display = "none";
        document.getElementById("suspended").style.display = "flex";
        updateSuspendTimer();
      }
      loadGame();
      var loadSteps = [
        "Inicjalizacja...",
        "Åadowanie interfejsu...",
        "Wczytywanie spraw...",
        "Konfiguracja narzÄ™dzi...",
        "Weryfikacja...",
        "System gotowy!",
      ];
      function runLoader() {
        if (checkSuspension()) return;
        var bar = document.getElementById("loader-bar"),
          pct = document.getElementById("loader-percent"),
          txt = document.getElementById("loader-text"),
          prog = 0;
        var iv = setInterval(function () {
          prog += Math.random() * 20 + 5;
          if (prog > 100) prog = 100;
          bar.style.width = prog + "%";
          pct.textContent = Math.floor(prog) + "%";
          txt.textContent = loadSteps[Math.min(Math.floor(prog / 20), 5)];
          if (prog >= 100) {
            clearInterval(iv);
            setTimeout(function () {
              document.getElementById("loader").style.display = "none";
              document.getElementById("intro").style.display = "flex";
            }, 400);
          }
        }, 200);
      }
      window.onload = runLoader;
      var scene,
        camera,
        renderer,
        objs = [],
        rotY = 0,
        rotX = 0,
        lookAt = null;
      function init3D() {
        scene = new THREE.Scene();
        scene.background = new THREE.Color(0x0a0a15);
        camera = new THREE.PerspectiveCamera(
          70,
          innerWidth / innerHeight,
          0.1,
          100
        );
        camera.position.set(0, 1.6, 0);
        renderer = new THREE.WebGLRenderer({
          canvas: document.getElementById("canvas"),
          antialias: true,
        });
        renderer.setSize(innerWidth, innerHeight);
        scene.add(new THREE.AmbientLight(0x1a2a4a, 0.5));
        var fl = new THREE.Mesh(
          new THREE.PlaneGeometry(10, 10),
          new THREE.MeshBasicMaterial({ color: 0x2a1810 })
        );
        fl.rotation.x = -Math.PI / 2;
        scene.add(fl);
        var dr = new THREE.Mesh(
          new THREE.BoxGeometry(2, 2.9, 0.1),
          new THREE.MeshBasicMaterial({ color: 0x4a3020 })
        );
        dr.position.set(0, 1.45, 4.9);
        dr.userData = { type: "door" };
        objs.push(dr);
        scene.add(dr);
        var mn = new THREE.Mesh(
          new THREE.BoxGeometry(1.2, 0.7, 0.05),
          new THREE.MeshBasicMaterial({ color: 0x003355 })
        );
        mn.position.set(0, 1.35, -3.2);
        mn.userData = { type: "pc" };
        objs.push(mn);
        scene.add(mn);
        animate();
      }
      function animate() {
        requestAnimationFrame(animate);
        camera.rotation.order = "YXZ";
        camera.rotation.y = rotY;
        camera.rotation.x = rotX;
        var ray = new THREE.Raycaster();
        ray.setFromCamera({ x: 0, y: 0 }, camera);
        var hits = ray.intersectObjects(objs);
        var pr = document.getElementById("prompt"),
          tb = document.getElementById("touch-btn");
        if (hits.length && hits[0].distance < 6) {
          lookAt = hits[0].object;
          var t = lookAt.userData.type == "pc" ? "KOMPUTER" : "DRZWI";
          pr.textContent = "ğŸ‘† " + t;
          pr.style.opacity = "1";
          if (!G.inPC) {
            tb.style.display = "block";
            tb.textContent = "ğŸ‘† " + t;
          }
        } else {
          lookAt = null;
          pr.style.opacity = "0";
          tb.style.display = "none";
        }
        renderer.render(scene, camera);
      }
      var md = false;
      document.onmousedown = function (e) {
        md = true;
        if (e.button == 0 && lookAt && !G.inPC) interact(lookAt);
      };
      document.onmouseup = function () {
        md = false;
      };
      document.onmousemove = function (e) {
        if (md && !G.inPC) {
          rotY -= e.movementX * 0.003;
          rotX = Math.max(-1, Math.min(1, rotX - e.movementY * 0.003));
        }
      };
      var tx = 0,
        ty = 0,
        tt = false,
        tm = false;
      document.ontouchstart = function (e) {
        if (
          G.inPC ||
          e.target.closest(
            "#computer,#visitor,#analysis,#result,#intro,#scene-overlay"
          )
        )
          return;
        tt = true;
        tm = false;
        tx = e.touches[0].clientX;
        ty = e.touches[0].clientY;
      };
      document.ontouchmove = function (e) {
        if (!tt || G.inPC) return;
        var dx = e.touches[0].clientX - tx,
          dy = e.touches[0].clientY - ty;
        if (Math.abs(dx) > 5 || Math.abs(dy) > 5) tm = true;
        rotY -= dx * 0.006;
        rotX = Math.max(-1, Math.min(1, rotX - dy * 0.006));
        tx = e.touches[0].clientX;
        ty = e.touches[0].clientY;
      };
      document.ontouchend = function () {
        if (!tt) return;
        tt = false;
        if (!tm && lookAt && !G.inPC) interact(lookAt);
      };
      function interact(o) {
        if (o.userData.type == "pc") enterPC();
        else spawnVisitor();
      }
      function enterPC() {
        G.inPC = true;
        document.getElementById("computer").style.display = "flex";
        document.getElementById("crosshair").style.display = "none";
        document.getElementById("prompt").style.opacity = "0";
        document.getElementById("touch-btn").style.display = "none";
        initNav();
        renderPanel("case");
      }
      function exitPC() {
        G.inPC = false;
        document.getElementById("computer").style.display = "none";
        document.getElementById("crosshair").style.display = "block";
      }
      document.getElementById("exit-btn").onclick = exitPC;
      function initNav() {
        var items = document.querySelectorAll(".nav-item");
        for (var i = 0; i < items.length; i++) {
          items[i].onclick = items[i].ontouchend = function (e) {
            e.preventDefault();
            for (var j = 0; j < items.length; j++)
              items[j].classList.remove("active");
            this.classList.add("active");
            renderPanel(this.dataset.panel);
          };
        }
      }
      function updateHUD() {
        document.getElementById("hud-credits").textContent = G.credits;
        document.getElementById("hud-cases").textContent = G.activeCases.length;
        document.getElementById("hud-day").textContent = G.day;
        var tax = getTotalTax();
        var taxEl = document.getElementById("hud-tax");
        if (taxEl) taxEl.textContent = tax + "%";
      }
      function notify(t, m) {
        document.getElementById("notif-title").textContent = t;
        document.getElementById("notif-msg").textContent = m;
        document.getElementById("notif").style.display = "block";
        setTimeout(function () {
          document.getElementById("notif").style.display = "none";
        }, 2500);
      }
      function renderPanel(p) {
        var c = document.getElementById("content");
        if (p == "case") c.innerHTML = renderCase();
        else if (p == "send") c.innerHTML = renderSend();
        else if (p == "inbox") c.innerHTML = renderInbox();
        else if (p == "shop") c.innerHTML = renderShop();
        else if (p == "archive") c.innerHTML = renderArchive();
        bindEvents(p);
      }
      function renderCase() {
        if (!G.activeCases.length)
          return '<div class="panel"><h2>ğŸ“‹ Brak Spraw</h2><p style="color:#888">Idz do DRZWI aby przyjac klienta.</p></div>';
        var h =
          '<div class="panel"><h2>ğŸ“‹ Aktywne Sprawy (' +
          G.activeCases.length +
          ")</h2>";
        for (var i = 0; i < G.activeCases.length; i++) {
          var c = G.activeCases[i],
            left = c.days - (G.day - c.startDay);
          var done = 0;
          for (var j = 0; j < c.evidence.length; j++) {
            if (c.evidence[j].verified) done++;
          }
          var ready = done == c.evidence.length;
          h +=
            '<div class="case-card' +
            (G.selectedCase == i ? " active" : "") +
            '" data-idx="' +
            i +
            '"><h4>' +
            c.avatar +
            " " +
            c.name +
            "</h4><p>" +
            c.type +
            " | â°" +
            left +
            " dni | " +
            (ready ? "âœ… Gotowe" : "ğŸ” " + done + "/" + c.evidence.length) +
            "</p></div>";
        }
        h += "</div>";
        if (G.selectedCase !== null && G.activeCases[G.selectedCase]) {
          var c = G.activeCases[G.selectedCase];
          h +=
            '<div class="panel"><h3 style="color:#fff;margin-bottom:10px">' +
            c.avatar +
            " " +
            c.name +
            " - " +
            c.type +
            '</h3><p style="color:#888;font-size:12px;margin-bottom:10px;line-height:1.5">' +
            c.fullStory +
            '</p><button class="chat-client-btn" data-cidx="' +
            G.selectedCase +
            '" style="background:#0ff;color:#000;border:none;padding:8px 15px;border-radius:5px;cursor:pointer;margin-bottom:15px">ğŸ’¬ Napisz do klienta (popros o wiecej screenow!)</button><h4 style="color:#0ff;margin-bottom:10px">ğŸ“ Dowody (' +
            c.evidence.length +
            '/4 max):</h4><div class="evidence-grid">';
          for (var j = 0; j < c.evidence.length; j++) {
            var e = c.evidence[j];
            h +=
              '<div class="evidence-card" data-eid="' +
              e.id +
              '"><div class="evidence-img"><img src="' +
              e.img +
              '"></div><span class="badge ' +
              (e.verified
                ? e.verdict
                  ? "badge-fake"
                  : "badge-ok"
                : "badge-pending") +
              '">' +
              (e.verified
                ? e.verdict
                  ? "âš ï¸ FALSZ"
                  : "âœ… OK"
                : "â“ Analizuj") +
              "</span></div>";
          }
          h += "</div></div>";
        }
        return h;
      }
      function renderSend() {
        var ready = G.activeCases.filter(function (c) {
          for (var i = 0; i < c.evidence.length; i++) {
            if (!c.evidence[i].verified) return false;
          }
          return true;
        });
        var partial = G.activeCases.filter(function (c) {
          var done = 0;
          for (var i = 0; i < c.evidence.length; i++) {
            if (c.evidence[i].verified) done++;
          }
          return done > 0 && done < c.evidence.length;
        });
        if (!ready.length) {
          var msg = "Przeanalizuj dowody!";
          if (partial.length)
            msg =
              "Przeanalizuj WSZYSTKIE dowody! (" +
              partial[0].name +
              ": " +
              partial[0].evidence.filter(function (e) {
                return e.verified;
              }).length +
              "/" +
              partial[0].evidence.length +
              ")";
          return (
            '<div class="panel"><h2>ğŸ“¤ Wyslij</h2><p style="color:#f90">' +
            msg +
            "</p></div>"
          );
        }
        var h =
          '<div class="panel"><h2>ğŸ“¤ Wyslij</h2><select id="case-sel" style="width:100%;padding:10px;background:#1a1a2e;border:1px solid #2a2a4e;color:#fff;border-radius:5px;margin-bottom:10px">';
        for (var i = 0; i < ready.length; i++) {
          var idx = G.activeCases.indexOf(ready[i]);
          h +=
            '<option value="' +
            idx +
            '">' +
            ready[i].name +
            " (" +
            ready[i].type +
            ") - " +
            ready[i].evidence.length +
            " dowodow</option>";
        }
        h +=
          '</select><p style="color:#f90;font-size:11px;margin-bottom:5px">âš ï¸ Bledne wnioski = GRZYWNA lub ZAWIESZENIE!</p><button id="mediator-btn" style="width:100%;background:linear-gradient(135deg,#fc0,#f90);color:#000;border:none;padding:10px;font-family:Orbitron;cursor:pointer;border-radius:8px;margin-bottom:15px;font-size:12px">ğŸ¤µ ZAPYTAJ POSREDNIKA</button><div class="recipient-grid"><div class="recipient-opt" data-r="Policja"><div class="icon">ğŸš”</div><div class="name">Policja</div></div><div class="recipient-opt" data-r="Sad"><div class="icon">âš–ï¸</div><div class="name">Sad</div></div></div><button class="send-btn" id="send-btn" disabled>ğŸ“¤ WYSLIJ</button></div>';
        return h;
      }
      function renderInbox() {
        if (!G.inbox.length)
          return '<div class="panel"><h2>ğŸ“¬ Poczta</h2><p style="color:#888">Brak.</p></div>';
        var h = '<div class="panel"><h2>ğŸ“¬ Poczta</h2>';
        for (var i = 0; i < G.inbox.length; i++) {
          var m = G.inbox[i];
          h +=
            '<div class="mail-item' +
            (m.read ? "" : " unread") +
            '" data-idx="' +
            i +
            '"><strong>' +
            m.from +
            '</strong><p style="color:#888;font-size:11px">' +
            m.body.substring(0, 40) +
            "...</p></div>";
        }
        return h + "</div>";
      }
      function renderShop() {
        var tax = getTotalTax();
        var h =
          '<div class="panel"><h2>ğŸ›’ Sklep</h2><p style="color:#f90;font-size:11px;margin-bottom:10px">âš ï¸ OpÅ‚ata za narzÄ™dzia: <strong>' +
          tax +
          "%</strong> z kaÅ¼dej wypÅ‚aty</p>";
        for (var k in TOOLS) {
          if (k == "zoom") continue;
          var t = TOOLS[k];
          var owned = G.tools[k];
          var sellPrice = Math.floor(t.p * 0.05);
          h +=
            '<div class="shop-item" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px"><span style="color:#fff">' +
            t.n +
            ' <span style="color:#f90;font-size:10px">(' +
            t.tax +
            "%)</span></span>";
          if (owned) {
            h +=
              '<button class="sell-btn" data-tool="' +
              k +
              '" style="background:#f36;color:#fff;border:none;padding:5px 10px;border-radius:5px;cursor:pointer;font-size:11px">Sprzedaj ' +
              sellPrice +
              "ğŸ’°</button>";
          } else {
            h +=
              '<button class="shop-btn" data-tool="' +
              k +
              '" ' +
              (G.credits < t.p ? "disabled" : "") +
              ' style="background:#0ff;color:#000;border:none;padding:5px 10px;border-radius:5px;cursor:pointer;font-size:11px">' +
              t.p +
              "ğŸ’°</button>";
          }
          h += "</div>";
        }
        return (
          h +
          '</div><div class="panel"><h2>âš™ï¸</h2><button id="reset-btn" style="background:#f36;color:#fff;border:none;padding:10px;border-radius:5px;cursor:pointer">ğŸ—‘ï¸ RESET</button></div>'
        );
      }
      function renderArchive() {
        var h = '<div class="panel"><h2>ğŸ“ Archiwum</h2>';
        if (!G.completed.length) h += '<p style="color:#888">Brak.</p>';
        for (var i = 0; i < G.completed.length; i++) {
          var c = G.completed[i];
          h +=
            '<div class="shop-item"><span>' +
            c.name +
            '</span><span style="color:' +
            (c.rew >= 0 ? "#0f8" : "#f36") +
            '">' +
            (c.rew >= 0 ? "+" : "") +
            c.rew +
            "ğŸ’°</span></div>";
        }
        return h + "</div>";
      }
      function bindEvents(p) {
        if (p == "case") {
          var cards = document.querySelectorAll(".case-card");
          for (var i = 0; i < cards.length; i++) {
            cards[i].onclick = cards[i].ontouchend = function (e) {
              e.preventDefault();
              G.selectedCase = parseInt(this.dataset.idx);
              saveGame();
              renderPanel("case");
            };
          }
          var evs = document.querySelectorAll(".evidence-card");
          for (var i = 0; i < evs.length; i++) {
            evs[i].onclick = evs[i].ontouchend = function (e) {
              e.preventDefault();
              openAnalysis(this.dataset.eid);
            };
          }
          var chatBtn = document.querySelector(".chat-client-btn");
          if (chatBtn) {
            chatBtn.onclick = chatBtn.ontouchend = function (e) {
              e.preventDefault();
              openClientChat(parseInt(this.dataset.cidx));
            };
          }
        }
        if (p == "send") {
          var sel = null;
          var opts = document.querySelectorAll(".recipient-opt");
          for (var i = 0; i < opts.length; i++) {
            opts[i].onclick = opts[i].ontouchend = function (e) {
              e.preventDefault();
              for (var j = 0; j < opts.length; j++)
                opts[j].classList.remove("selected");
              this.classList.add("selected");
              sel = this.dataset.r;
              document.getElementById("send-btn").disabled = false;
            };
          }
          document.getElementById("send-btn").onclick = document.getElementById(
            "send-btn"
          ).ontouchend = function (e) {
            e.preventDefault();
            if (sel) {
              var idx = parseInt(document.getElementById("case-sel").value);
              finishCase(idx, sel);
            }
          };
          var mb = document.getElementById("mediator-btn");
          if (mb) {
            mb.onclick = mb.ontouchend = function (e) {
              e.preventDefault();
              openMediatorChat();
            };
          }
        }
        if (p == "inbox") {
          var items = document.querySelectorAll(".mail-item");
          for (var i = 0; i < items.length; i++) {
            items[i].onclick = items[i].ontouchend = function (e) {
              e.preventDefault();
              var m = G.inbox[this.dataset.idx];
              m.read = true;
              saveGame();
              alert(m.from + "\n\n" + m.body);
              renderPanel("inbox");
            };
          }
        }
        if (p == "shop") {
          var btns = document.querySelectorAll(".shop-btn");
          for (var i = 0; i < btns.length; i++) {
            btns[i].onclick = btns[i].ontouchend = function (e) {
              e.preventDefault();
              var t = this.dataset.tool;
              if (!G.tools[t] && G.credits >= TOOLS[t].p) {
                G.credits -= TOOLS[t].p;
                G.tools[t] = true;
                updateHUD();
                saveGame();
                renderPanel("shop");
                notify(
                  "Kupiono!",
                  TOOLS[t].n + " (-" + TOOLS[t].tax + "% z wypÅ‚at)"
                );
              }
            };
          }
          var sellBtns = document.querySelectorAll(".sell-btn");
          for (var i = 0; i < sellBtns.length; i++) {
            sellBtns[i].onclick = sellBtns[i].ontouchend = function (e) {
              e.preventDefault();
              var t = this.dataset.tool;
              if (G.tools[t]) {
                sellTool(t);
                renderPanel("shop");
              }
            };
          }
          var rb = document.getElementById("reset-btn");
          if (rb)
            rb.onclick = function () {
              if (confirm("Reset?")) {
                localStorage.clear();
                location.reload();
              }
            };
        }
      }
      var curEv = null,
        curCase = null;
      function openAnalysis(eid) {
        if (G.selectedCase === null) return;
        curCase = G.activeCases[G.selectedCase];
        curEv = null;
        for (var i = 0; i < curCase.evidence.length; i++) {
          if (curCase.evidence[i].id == eid) curEv = curCase.evidence[i];
        }
        if (!curEv) return;
        document.getElementById("analysis-img").src = curEv.img;
        document.getElementById("analysis").style.display = "flex";
        if (!G.results[curCase.id]) G.results[curCase.id] = {};
        if (!G.results[curCase.id][eid]) G.results[curCase.id][eid] = {};
        saveGame();
        renderTools();
      }
      document.getElementById("close-analysis").onclick = function () {
        document.getElementById("analysis").style.display = "none";
      };
      function renderTools() {
        var res = G.results[curCase.id][curEv.id] || {};
        var h =
          '<div style="padding:5px"><h4 style="color:#0ff;margin-bottom:8px">NARZÄ˜DZIA</h4>';
        for (var k in TOOLS) {
          var t = TOOLS[k],
            have = G.tools[k],
            used = res[k];
          h +=
            '<button class="tool-btn' +
            (have ? "" : " locked") +
            (used ? " active" : "") +
            '" data-t="' +
            k +
            '">' +
            t.n +
            " " +
            (have ? (used ? "âœ“" : "") : t.p + "ğŸ’°") +
            "</button>";
        }
        h += '</div><div id="results-box"><h5 style="color:#0ff">ğŸ“Š</h5>';
        for (var k in res) {
          if (!res[k]) continue;
          h +=
            '<div class="result-row"><span>' +
            TOOLS[k].n +
            '</span><span class="result-val ' +
            (res[k].s ? "sus" : "ok") +
            '">' +
            (res[k].s ? "âš ï¸" : "âœ“") +
            '</span></div><p style="color:#888;font-size:10px">' +
            res[k].i +
            "</p>";
        }
        h +=
          '</div><div id="verdict-btns"><button class="verdict-btn v-ok" id="v-ok">âœ“ OK</button><button class="verdict-btn v-fake" id="v-fake">âœ— FAÅSZ</button></div>';
        document.getElementById("tools-panel").innerHTML = h;
        var btns = document.querySelectorAll(".tool-btn");
        for (var i = 0; i < btns.length; i++) {
          btns[i].onclick = btns[i].ontouchend = function (e) {
            e.preventDefault();
            var t = this.dataset.t;
            if (!G.tools[t]) {
              notify("Brak!", "Kup w sklepie");
              return;
            }
            if (t == "zoom") {
              var img = document.getElementById("analysis-img");
              if (!img.dataset.zoomed || img.dataset.zoomed == "false") {
                img.style.transform = "scale(2.5)";
                img.style.cursor = "zoom-out";
                img.dataset.zoomed = "true";
                notify("ğŸ” Lupa", "PowiÄ™kszono 2.5x");
                G.results[curCase.id][curEv.id]["zoom"] = {
                  s: 0,
                  i: "PowiÄ™kszenie aktywne",
                };
              } else {
                img.style.transform = "scale(1)";
                img.style.cursor = "zoom-in";
                img.dataset.zoomed = "false";
                notify("ğŸ” Lupa", "Normalny rozmiar");
              }
              renderTools();
              return;
            }
            if (!curEv.ind || !curEv.ind[t]) return;
            if (G.results[curCase.id][curEv.id][t]) return;
            G.results[curCase.id][curEv.id][t] = curEv.ind[t];
            renderTools();
            saveGame();
            notify(TOOLS[t].n, curEv.ind[t].s ? "âš ï¸ PODEJRZANE!" : "âœ“ OK");
          };
        }
        document.getElementById("v-ok").onclick = document.getElementById(
          "v-ok"
        ).ontouchend = function (e) {
          e.preventDefault();
          verdict(false);
        };
        document.getElementById("v-fake").onclick = document.getElementById(
          "v-fake"
        ).ontouchend = function (e) {
          e.preventDefault();
          verdict(true);
        };
      }
      function verdict(isFake) {
        curEv.verified = true;
        curEv.verdict = isFake;
        document.getElementById("analysis").style.display = "none";
        saveGame();
        renderPanel("case");
        if (curCase.evidence[0].verified) {
          notify("Gotowe!", "WyÅ›lij");
          document.querySelector('[data-panel="send"]').classList.add("notify");
        }
      }
      var chatCaseIdx = null;
      function openClientChat(idx) {
        chatCaseIdx = idx;
        var c = G.activeCases[idx];
        if (!c.chatHistory) c.chatHistory = [];
        document.getElementById("chat-client-name").textContent =
          "ğŸ’¬ " + c.avatar + " " + c.name;
        renderChatMessages(c);
        document.getElementById("client-chat").style.display = "flex";
      }
      function renderChatMessages(c) {
        var h =
          '<div class="chat-msg client">' +
          c.avatar +
          ": Dzien dobry! Dziekuje ze sie Pan/Pani zajmuje moja sprawa. Jesli potrzeba wiecej screenow - prosze pisac!</div>";
        if (c.chatHistory) {
          for (var i = 0; i < c.chatHistory.length; i++) {
            var m = c.chatHistory[i];
            var txt = m.text;
            var imgHtml = "";
            if (txt.indexOf("__IMG__") >= 0 && txt.indexOf("__ENDIMG__") >= 0) {
              var imgStart = txt.indexOf("__IMG__") + 7;
              var imgEnd = txt.indexOf("__ENDIMG__");
              var imgSrc = txt.substring(imgStart, imgEnd);
              imgHtml =
                '<div style="background:#0a0a15;padding:8px;border-radius:8px;margin:8px 0"><img src="' +
                imgSrc +
                '" style="max-width:100%;border-radius:5px;border:2px solid #0ff"><p style="color:#0ff;font-size:10px;margin-top:5px">ğŸ“ NOWY DOWOD - sprawdz w SPRAWY</p></div>';
              txt = txt.substring(imgEnd + 10);
            }
            h +=
              '<div class="chat-msg ' +
              m.from +
              '" style="margin-bottom:12px">' +
              (m.from == "you"
                ? '<b style="color:#0ff">Ty:</b> '
                : "<b>" + c.avatar + ":</b> ") +
              txt +
              imgHtml +
              "</div>";
          }
        }
        document.getElementById("chat-messages").innerHTML = h;
        var msgs = document.getElementById("chat-messages");
        msgs.scrollTop = msgs.scrollHeight;
      }
      function getClientResponse(c, msg) {
        var m = msg.toLowerCase();
        // POZDROWIENIA
        if (
          m.indexOf("dzien dobry") >= 0 ||
          m.indexOf("dzieÅ„ dobry") >= 0 ||
          m.indexOf("hej") >= 0 ||
          m.indexOf("czesc") >= 0 ||
          m.indexOf("czeÅ›Ä‡") >= 0 ||
          m.indexOf("witam") >= 0 ||
          m.indexOf("siema") >= 0 ||
          m.indexOf("hello") >= 0
        )
          return "DzieÅ„ dobry! DziÄ™kujÄ™ Å¼e Pan/Pani siÄ™ zajmuje mojÄ… sprawÄ…. Jak mogÄ™ pomÃ³c?";
        if (
          m.indexOf("jak sie masz") >= 0 ||
          m.indexOf("jak siÄ™ masz") >= 0 ||
          m.indexOf("co slychac") >= 0 ||
          m.indexOf("co sÅ‚ychaÄ‡") >= 0
        )
          return "Szczerze? Kiepsko... Ta sytuacja bardzo mnie stresuje. Ale dziÄ™kujÄ™ Å¼e Pan/Pani pyta.";
        if (
          m.indexOf("dobranoc") >= 0 ||
          m.indexOf("do widzenia") >= 0 ||
          m.indexOf("pa") >= 0 ||
          m.indexOf("nara") >= 0
        )
          return "Do widzenia! ProszÄ™ daÄ‡ znaÄ‡ jak bÄ™dÄ… jakieÅ› postÄ™py w sprawie.";
        // SCREENY
        var wantsScreens =
          m.indexOf("screen") >= 0 ||
          m.indexOf("zdj") >= 0 ||
          m.indexOf("foto") >= 0 ||
          m.indexOf("dowod") >= 0 ||
          m.indexOf("dowÃ³d") >= 0 ||
          m.indexOf("wyslij") >= 0 ||
          m.indexOf("wyÅ›lij") >= 0 ||
          m.indexOf("przeslij") >= 0 ||
          m.indexOf("przeÅ›lij") >= 0 ||
          m.indexOf("pokaz") >= 0 ||
          m.indexOf("pokaÅ¼") >= 0 ||
          m.indexOf("wiecej") >= 0 ||
          m.indexOf("wiÄ™cej") >= 0 ||
          m.indexOf("jeszcze") >= 0;
        if (wantsScreens) {
          if (!c.extraScreensSent) c.extraScreensSent = 0;
          if (c.extraScreensSent >= 3)
            return (
              "To juÅ¼ wszystko co mam. WysÅ‚aÅ‚em/am juÅ¼ " +
              c.evidence.length +
              " screenÃ³w - wiÄ™cej nie posiadam. Przepraszam!"
            );
          c.extraScreensSent++;
          var baseEv = c.evidence[0];
          var isFake = baseEv.fake;
          var screenTexts = {
            STALKING: [
              "WidziaÅ‚em ciÄ™ dzisiaj w Å»abce o 17:23. KupiÅ‚aÅ› mleko i buÅ‚ki.",
              "Åadna ta czerwona kurtka. Pasuje ci.",
              "Twoja koleÅ¼anka z pracy ma na imiÄ™ Asia, prawda? CzÄ™sto razem jecie lunch.",
              "Wczoraj wrÃ³ciÅ‚aÅ› do domu o 21:37. PÃ³Åºno.",
              "Wiem Å¼e byÅ‚aÅ› u fryzjera. Nowa fryzura ci pasuje.",
              "TwÃ³j samochÃ³d staÅ‚ dzisiaj pod galeriÄ… handlowÄ… od 14:00 do 16:30.",
              "WidziaÅ‚em jak rozmawiaÅ‚aÅ› z tym facetem. Kto to byÅ‚?",
              "Nie ignoruj mnie. Wiem gdzie jesteÅ›.",
              "Dlaczego nie odpisujesz? WidzÄ™ Å¼e czytasz.",
              "Twoje okno byÅ‚o otwarte wczoraj w nocy. Niebezpiecznie.",
              "Ten facet co ciÄ™ odwiedziÅ‚ w sobotÄ™ - to twÃ³j brat czy ktoÅ› inny?",
              "Lubisz tÄ™ kawiarniÄ™ przy rynku, prawda? CzÄ™sto tam chodzisz.",
              "WidziaÅ‚em ciÄ™ na siÅ‚owni. Ä†wiczysz w poniedziaÅ‚ki i Å›rody.",
              "Åšlicznie wyglÄ…dasz w tej niebieskiej sukience.",
              "ZauwaÅ¼yÅ‚em Å¼e zmieniÅ‚aÅ› trasÄ™ do pracy. Dlaczego?",
            ],
            GROÅ¹BY: [
              "ZnajdÄ™ ciÄ™ i poÅ¼aÅ‚ujesz Å¼e siÄ™ urodziÅ‚eÅ›.",
              "Wiem gdzie mieszkasz. Wiem gdzie pracujesz. UwaÅ¼aj.",
              "Ty i twoja rodzina zapÅ‚acicie za to co zrobiÅ‚eÅ›.",
              "Lepiej oglÄ…daj siÄ™ za siebie jak wychodzisz z domu.",
              "To ostrzeÅ¼enie. NastÄ™pnym razem nie bÄ™dÄ™ taki miÅ‚y.",
              "ZniszczÄ™ ci Å¼ycie. PoÅ¼aÅ‚ujesz.",
              "Masz 24h Å¼eby przeprosiÄ‡. Potem bÄ™dzie Åºle.",
              "Wiem gdzie chodzi twoje dziecko do szkoÅ‚y.",
              "TwÃ³j samochÃ³d Å‚adnie wyglÄ…da. Szkoda jakby mu siÄ™ coÅ› staÅ‚o.",
              "Nie Å›pij spokojnie. Nigdy nie wiesz kiedy przyjdÄ™.",
              "ZabijÄ™ ciÄ™ sk***synu. To nie jest groÅºba, to obietnica.",
              "Lepiej siÄ™ wyprowadÅº z miasta. Dla twojego dobra.",
              "Mam znajomych ktÃ³rzy chÄ™tnie ciÄ™ odwiedzÄ….",
              "PamiÄ™taj - zawsze ciÄ™ znajdÄ™.",
              "To dopiero poczÄ…tek. BÄ™dzie gorzej.",
            ],
            ZNIESÅAWIENIE: [
              "UWAGA! Ta osoba to oszust! Nie rÃ³bcie z niÄ… interesÃ³w!",
              "Oficjalnie informujÄ™ Å¼e [imiÄ™] kradnie pieniÄ…dze klientom.",
              "Mam dowody Å¼e ta osoba jest pedofilem. UdostÄ™pniajcie!",
              "[imiÄ™] zdradza Å¼onÄ™/mÄ™Å¼a z wieloma osobami. Mam zdjÄ™cia.",
              "Ta osoba rozprowadza narkotyki. KaÅ¼dy w mieÅ›cie wie.",
              "SKANDAL! [imiÄ™] braÅ‚ Å‚apÃ³wki gdy pracowaÅ‚ w urzÄ™dzie!",
              "Ostrzegam wszystkich - ta osoba ma AIDS i tego nie mÃ³wi.",
              "[imiÄ™] to zÅ‚odziej! UkradÅ‚ mi 10000 zÅ‚! Uwaga na niego!",
              "Mam nagranie jak [imiÄ™] bije swojÄ… Å¼onÄ™. PotwÃ³r!",
              "Ta osoba byÅ‚a w wiÄ™zieniu za gwaÅ‚t. SprawdÅºcie sami.",
              "[imiÄ™] oszukuje na wadze produktÃ³w w swoim sklepie!",
              "UWAGA NA OSZUSTA! Sprzedaje podrÃ³bki jako oryginaÅ‚y!",
              "Ta osoba to alkoholik ktÃ³ry bije swoje dzieci.",
              "[imiÄ™] wyÅ‚udza pieniÄ…dze od starszych osÃ³b! PrzekrÄ™t!",
              "Mam dowody na defraudacjÄ™ w firmie [imiÄ™]. ZÅ‚odziej!",
            ],
            OSZUSTWO: [
              "Przelej 500 zÅ‚ na weryfikacjÄ™ konta, potem zwrÃ³cÄ™ 5000 zÅ‚.",
              "Gratulacje! WygraÅ‚eÅ› iPhone! WpÅ‚aÄ‡ tylko 99 zÅ‚ za wysyÅ‚kÄ™.",
              "Jestem z banku, proszÄ™ podaÄ‡ kod BLIK do weryfikacji.",
              "Sprzedam tanio - PlayStation 5 za 800 zÅ‚, nowe w folii!",
              "Mama, zgubiÅ‚am telefon, to mÃ³j nowy numer. PoÅ¼ycz 2000 zÅ‚ pilnie.",
              "Twoja paczka czeka, dopÅ‚aÄ‡ 12 zÅ‚ cÅ‚a klikajÄ…c w link.",
              "Pilne! Twoje konto zostanie zablokowane. Zaloguj siÄ™ tutaj.",
              "OferujÄ™ pracÄ™ zdalnÄ… - 500 zÅ‚ dziennie! WpÅ‚aÄ‡ 200 zÅ‚ na start.",
              "Sprzedam samochÃ³d, wyjazd za granicÄ™, cena do negocjacji.",
              "Zainwestuj 1000 zÅ‚, zarobisz 10000 zÅ‚ w tydzieÅ„! Gwarancja!",
              "Kup kryptowalutÄ™ XYZ zanim eksploduje! Zostaw mi pieniÄ…dze.",
              "Loteria wybraÅ‚a twÃ³j numer! WpÅ‚aÄ‡ podatek 300 zÅ‚ po odbiÃ³r.",
              "Sprzedam bilety na koncert - taÅ„sze niÅ¼ w kasie!",
              "TwÃ³j komputer ma wirusa! ZadzwoÅ„ pod ten numer natychmiast.",
              "Jestem prawnikiem, masz spadek do odebrania. OpÅ‚ata 500 zÅ‚.",
            ],
            HACKING: [
              "Mamy dostÄ™p do twojego konta. WpÅ‚aÄ‡ 2 BTC lub wszystko ujawnimy.",
              "Twoje hasÅ‚o to [hasÅ‚o]. Widzimy wszystko co robisz.",
              "NagraliÅ›my ciÄ™ przez kamerkÄ™. Mamy wszystko. PÅ‚aÄ‡ albo publikujemy.",
              "WÅ‚amaliÅ›my siÄ™ na twoje social media. Wszystkie hasÅ‚a mamy.",
              "Twoje zdjÄ™cia i dokumenty sÄ… nasze. Szyfrujemy dysk.",
              "ZmieniliÅ›my ci hasÅ‚a wszÄ™dzie. Chcesz odzyskaÄ‡ dostÄ™p? PÅ‚aÄ‡.",
              "Mamy twoje dane bankowe. WspÃ³Å‚pracuj albo je wykorzystamy.",
              "WÅ‚aÅ›nie przelaliÅ›my 5000 zÅ‚ z twojego konta. DziÄ™ki za hasÅ‚o.",
              "Twoja poczta naleÅ¼y teraz do nas. Widzimy wszystkie maile.",
              "Admin panel twojej strony jest nasz. PÅ‚aÄ‡ albo kasujemy.",
              "WykradliÅ›my bazÄ™ danych klientÃ³w. Masz 48h.",
              "TwÃ³j telefon jest zhakowany. Widzimy wszystko w czasie rzeczywistym.",
              "Mamy dostÄ™p do twojego dysku Google. Wszystkie pliki nasze.",
              "Keylogger zainstalowany. Widzimy kaÅ¼de naciÅ›niÄ™cie klawisza.",
              "Twoja sieÄ‡ WiFi jest nasza. Monitorujemy caÅ‚y ruch.",
            ],
            SZANTAÅ»: [
              "Mam twoje prywatne zdjÄ™cia. WpÅ‚aÄ‡ 5000 zÅ‚ albo wyÅ›lÄ™ wszystkim.",
              "NagraÅ‚em naszÄ… rozmowÄ™ wideo. Chcesz Å¼eby rodzina zobaczyÅ‚a?",
              "Wiem o twojej zdradzie. Mam dowody. PÅ‚aÄ‡ albo Å¼ona siÄ™ dowie.",
              "Znam twÃ³j sekret. 3000 zÅ‚ i zapomnÄ™ o wszystkim.",
              "Mam screeny twoich rozmÃ³w. WyobraÅº sobie co powiedzÄ… w pracy.",
              "Twoje prywatne filmy sÄ… bezpieczne. Na razie. PÅ‚aÄ‡ co miesiÄ…c.",
              "OpublikujÄ™ wszystko na Facebooku jeÅ›li nie przeÅ›lesz pieniÄ™dzy.",
              "Mam zdjÄ™cia ktÃ³rych nie chcesz Å¼eby ktoÅ› zobaczyÅ‚. Dogadajmy siÄ™.",
              "Twoi znajomi na FB dostanÄ… ciekawy materiaÅ‚. Chyba Å¼e...",
              "Wiem gdzie pracujesz. Szef na pewno chciaÅ‚by to zobaczyÄ‡.",
              "Mam nagranie z kamery. Wiesz o czym mÃ³wiÄ™. 10000 zÅ‚.",
              "Wszystkie twoje sekrety mogÄ… wyjÅ›Ä‡ na jaw. Cena: 8000 zÅ‚.",
              "To byÅ‚aby szkoda gdyby dzieci zobaczyÅ‚y te zdjÄ™cia mamy/taty.",
              "Media spoÅ‚ecznoÅ›ciowe to potÄ™Å¼na broÅ„. Mam amunicjÄ™.",
              "MoÅ¼emy to zaÅ‚atwiÄ‡ po cichu. Albo wszyscy siÄ™ dowiedzÄ….",
            ],
            PODSZYWANIE: [
              "[FaÅ‚szywy profil] SprzedajÄ™ oryginalne produkty Apple 50% taniej!",
              "[FaÅ‚szywy profil] Polacy to najgorszy narÃ³d! Won z imigrantami!",
              "[FaÅ‚szywy profil] OszukujÄ™ klientÃ³w od lat i nic mi nie zrobicie.",
              "[FaÅ‚szywy profil] Moja firma to Å›ciema, nie kupujcie u mnie.",
              "[FaÅ‚szywy profil] Zdradzam partnera z wieloma osobami hehe.",
              "[FaÅ‚szywy profil] Jestem za legalizacjÄ… wszystkich narkotykÃ³w!",
              "[FaÅ‚szywy profil] NienawidzÄ™ swojej pracy i klientÃ³w.",
              "[FaÅ‚szywy profil] KradnÄ™ pomysÅ‚y od innych i podajÄ™ jako swoje.",
              "[FaÅ‚szywy profil] Moje produkty sÄ… podrabiane ale sprzedajÄ™ drogo.",
              "[FaÅ‚szywy profil] GÅ‚osowaÅ‚em na [kontrowersyjna partia] i jestem dumny!",
              "[FaÅ‚szywy profil] PÅ‚acÄ™ pracownikom grosze a sam mam Porsche.",
              "[FaÅ‚szywy profil] WyrzuciÅ‚em pracownika bo mi siÄ™ nie podobaÅ‚.",
              "[FaÅ‚szywy profil] KÅ‚amiÄ™ w CV i oszukujÄ™ pracodawcÃ³w od lat.",
              "[FaÅ‚szywy profil] Moja firma nie pÅ‚aci podatkÃ³w. I co mi zrobicie?",
              "[FaÅ‚szywy profil] Zaczynam nowy biznes - piramida finansowa!",
            ],
          };
          var typeKey = c.type;
          var textsForType = screenTexts[typeKey] || screenTexts["GROÅ¹BY"];
          if (!c.usedScreenTexts) c.usedScreenTexts = [];
          var availableTexts = textsForType.filter(function (t) {
            return c.usedScreenTexts.indexOf(t) < 0;
          });
          if (availableTexts.length == 0) availableTexts = textsForType;
          var randomText =
            availableTexts[Math.floor(Math.random() * availableTexts.length)];
          c.usedScreenTexts.push(randomText);
          var newEv = {
            id: "e" + c.id + "_" + c.extraScreensSent,
            tp: baseEv.tp + " #" + (c.evidence.length + 1),
            fake: isFake,
            txt: randomText,
            verified: false,
            verdict: null,
            ind: {
              meta: {
                s: isFake ? 1 : 0,
                i: isFake
                  ? "Plik edytowany w " +
                    ["Photoshop", "GIMP", "Paint.NET", "Canva", "Pixlr"][
                      Math.floor(Math.random() * 5)
                    ]
                  : "Oryginalny plik - brak edycji",
              },
              ela: {
                s: isFake ? 1 : 0,
                i: isFake
                  ? "Wykryto Å›lady manipulacji pikseli"
                  : "Brak Å›ladÃ³w manipulacji",
              },
              font: {
                s: isFake ? 1 : 0,
                i: isFake
                  ? "Czcionka niezgodna z aplikacjÄ… " + baseEv.tp
                  : "Czcionka zgodna z " + baseEv.tp,
              },
              time: {
                s: isFake ? 1 : 0,
                i: isFake
                  ? "Znacznik czasu podejrzany/niemoÅ¼liwy"
                  : "Znaczniki czasowe prawidÅ‚owe",
              },
              ai: {
                s: isFake ? 1 : 0,
                i: isFake
                  ? 78 +
                    Math.floor(Math.random() * 18) +
                    "% - prawdopodobnie faÅ‚szywy"
                  : 1 +
                    Math.floor(Math.random() * 9) +
                    "% - wyglÄ…da na autentyczny",
              },
            },
          };
          newEv.img = genImg(newEv);
          c.evidence.push(newEv);
          if (!G.results[c.id]) G.results[c.id] = {};
          G.results[c.id][newEv.id] = {};
          saveGame();
          setTimeout(function () {
            notify(
              "ğŸ“ Nowy dowÃ³d!",
              "Screen #" + c.evidence.length + " dodany!"
            );
            renderPanel("case");
          }, 300);
          return (
            "__IMG__" +
            newEv.img +
            "__ENDIMG__WysyÅ‚am screen #" +
            c.evidence.length +
            "! Mam jeszcze " +
            (3 - c.extraScreensSent) +
            ". SprawdÅº w zakÅ‚adce SPRAWY."
          );
        }
        // STALKING
        if (c.type == "STALKING") {
          if (
            m.indexOf("ile") >= 0 &&
            (m.indexOf("wiadom") >= 0 || m.indexOf("razy") >= 0)
          )
            return "DostajÄ™ po 10-20 wiadomoÅ›ci dziennie. Czasem wiÄ™cej. To nie ustaje od tygodni.";
          if (
            m.indexOf("gdzie") >= 0 &&
            (m.indexOf("widzi") >= 0 ||
              m.indexOf("Å›ledzi") >= 0 ||
              m.indexOf("sledzi") >= 0)
          )
            return "WidziaÅ‚ mnie w kawiarni, pod pracÄ…, w sklepie, na siÅ‚owni... DosÅ‚ownie wszÄ™dzie!";
          if (m.indexOf("blokow") >= 0 || m.indexOf("zablokowac") >= 0)
            return "BlokowaÅ‚am go juÅ¼ z 10 razy! Ale ciÄ…gle zakÅ‚ada nowe konta i pisze dalej.";
          if (
            m.indexOf("od kiedy") >= 0 ||
            m.indexOf("jak dlugo") >= 0 ||
            m.indexOf("jak dÅ‚ugo") >= 0
          )
            return "To trwa juÅ¼ prawie 3 miesiÄ…ce, od naszego rozstania. Nie odpuszcza.";
          if (
            m.indexOf("boisz") >= 0 ||
            m.indexOf("strach") >= 0 ||
            m.indexOf("bezpiecz") >= 0
          )
            return "Tak, bardzo siÄ™ bojÄ™! Nie wychodzÄ™ sama z domu. CzujÄ™ siÄ™ obserwowana 24/7.";
          if (m.indexOf("policj") >= 0)
            return "ByÅ‚am na policji ale powiedzieli Å¼e to za maÅ‚o dowodÃ³w. Dlatego do Pana/Pani przyszÅ‚am.";
          if (m.indexOf("numer") >= 0 || m.indexOf("telefon") >= 0)
            return "Pisze z rÃ³Å¼nych numerÃ³w. BlokujÄ™ jeden, pojawia siÄ™ nastÄ™pny.";
        }
        // GROÅ¹BY
        if (c.type == "GROÅ¹BY") {
          if (
            m.indexOf("ile") >= 0 &&
            (m.indexOf("wiadom") >= 0 ||
              m.indexOf("groz") >= 0 ||
              m.indexOf("groÅº") >= 0 ||
              m.indexOf("razy") >= 0)
          )
            return "DostaÅ‚em/am juÅ¼ ponad 20 takich wiadomoÅ›ci. KaÅ¼da gorsza od poprzedniej!";
          if (
            m.indexOf("grupa") >= 0 ||
            m.indexOf("ile osob") >= 0 ||
            m.indexOf("ile osÃ³b") >= 0
          )
            return "To chyba 4-5 osÃ³b w grupie. PiszÄ… z rÃ³Å¼nych kont ale styl podobny.";
          if (m.indexOf("policj") >= 0)
            return "ZgÅ‚osiÅ‚em/am na policjÄ™ ale powiedzieli Å¼e potrzebujÄ… wiÄ™cej dowodÃ³w.";
          if (m.indexOf("boisz") >= 0 || m.indexOf("strach") >= 0)
            return "Tak, bojÄ™ siÄ™ o siebie i rodzinÄ™! GroÅ¼Ä… Å¼e wiedzÄ… gdzie mieszkam!";
          if (
            m.indexOf("skad") >= 0 ||
            m.indexOf("skÄ…d") >= 0 ||
            m.indexOf("dlaczego") >= 0
          )
            return "Nie wiem skÄ…d ta nienawiÅ›Ä‡... MoÅ¼e to przez konflikt w pracy/szkole.";
          if (m.indexOf("anonimow") >= 0)
            return "Tak, piszÄ… z anonimowych kont. Nie mogÄ™ ustaliÄ‡ kim sÄ….";
        }
        // ZNIESÅAWIENIE
        if (c.type == "ZNIESÅAWIENIE") {
          if (
            m.indexOf("gdzie") >= 0 &&
            (m.indexOf("opublik") >= 0 || m.indexOf("post") >= 0)
          )
            return "To byÅ‚o na Facebooku i jakimÅ› forum lokalnym. Post byÅ‚ udostÄ™pniany setki razy!";
          if (
            m.indexOf("ile") >= 0 &&
            (m.indexOf("osob") >= 0 ||
              m.indexOf("osÃ³b") >= 0 ||
              m.indexOf("ludzi") >= 0)
          )
            return "WidziaÅ‚o to setki osÃ³b! NiektÃ³rzy nawet mi to wysyÅ‚ali z pytaniem czy to prawda.";
          if (m.indexOf("usun") >= 0 || m.indexOf("skasow") >= 0)
            return "ZgÅ‚aszaÅ‚em/am do usuniÄ™cia ale platforma nie reaguje. Dalej tam wisi!";
          if (m.indexOf("strac") >= 0 || m.indexOf("szkod") >= 0)
            return "StraciÅ‚em/am klientÃ³w, znajomych siÄ™ odsunÄ™Å‚o, w pracy patrzÄ… dziwnie...";
          if (
            m.indexOf("prawda") >= 0 ||
            m.indexOf("klamstw") >= 0 ||
            m.indexOf("kÅ‚amstw") >= 0
          )
            return "To totalne kÅ‚amstwa! Nigdy czegoÅ› takiego nie zrobiÅ‚em/am!";
        }
        // OSZUSTWO
        if (c.type == "OSZUSTWO") {
          if (
            m.indexOf("ile") >= 0 &&
            (m.indexOf("pieniedz") >= 0 ||
              m.indexOf("pieniÄ™dz") >= 0 ||
              m.indexOf("zl") >= 0 ||
              m.indexOf("strac") >= 0)
          )
            return "StraciÅ‚em/am kilka tysiÄ™cy zÅ‚otych. CaÅ‚e oszczÄ™dnoÅ›ci Å¼ycia!";
          if (m.indexOf("przelew") >= 0 || m.indexOf("bank") >= 0)
            return "Mam potwierdzenie przelewu. PieniÄ…dze poszÅ‚y i przepadÅ‚y.";
          if (m.indexOf("kontakt") >= 0 || m.indexOf("odpis") >= 0)
            return "PrÃ³bowaÅ‚em/am siÄ™ kontaktowaÄ‡ ale oszust zniknÄ…Å‚. Konto usuniÄ™te, telefon martwy.";
          if (m.indexOf("jak") >= 0 && m.indexOf("oszuk") >= 0)
            return "UdawaÅ‚ Å¼e sprzedaje coÅ› tanio. ZapÅ‚aciÅ‚em/am i nigdy nie dostaÅ‚em towaru.";
          if (m.indexOf("policj") >= 0)
            return "Policja mÃ³wi Å¼e trudno namierzyÄ‡ bo konta fake. Dlatego potrzebujÄ™ pomocy!";
        }
        // HACKING
        if (c.type == "HACKING") {
          if (m.indexOf("haslo") >= 0 || m.indexOf("hasÅ‚o") >= 0)
            return "Moje hasÅ‚o byÅ‚o silne... ale chyba wyciekÅ‚o gdzieÅ› z bazy danych.";
          if (
            m.indexOf("ile") >= 0 &&
            (m.indexOf("pieniedz") >= 0 || m.indexOf("pieniÄ™dz") >= 0)
          )
            return "Ukradli mi kilkanaÅ›cie tysiÄ™cy zÅ‚otych z konta!";
          if (
            m.indexOf("phishing") >= 0 ||
            m.indexOf("link") >= 0 ||
            m.indexOf("mail") >= 0
          )
            return "Tak, kliknÄ…Å‚em w jakiÅ› link... GÅ‚upia pomyÅ‚ka. Strona wyglÄ…daÅ‚a jak bank.";
          if (m.indexOf("konto") >= 0)
            return "WÅ‚amali siÄ™ na moje konto bankowe i do social media!";
        }
        // SZANTAÅ»
        if (c.type == "SZANTAÅ»") {
          if (
            m.indexOf("ile") >= 0 &&
            (m.indexOf("zada") >= 0 ||
              m.indexOf("Å¼Ä…da") >= 0 ||
              m.indexOf("chce") >= 0)
          )
            return "Å»Ä…dajÄ… ode mnie kilku tysiÄ™cy zÅ‚otych! To szaleÅ„stwo!";
          if (
            m.indexOf("zaplac") >= 0 ||
            m.indexOf("zapÅ‚ac") >= 0 ||
            m.indexOf("placic") >= 0 ||
            m.indexOf("pÅ‚acic") >= 0
          )
            return "Nie chcÄ™ pÅ‚aciÄ‡! BojÄ™ siÄ™ Å¼e i tak opublikujÄ…. Szukam innego wyjÅ›cia.";
          if (
            m.indexOf("zdjec") >= 0 ||
            m.indexOf("zdjÄ™c") >= 0 ||
            m.indexOf("material") >= 0 ||
            m.indexOf("materiaÅ‚") >= 0
          )
            return "To... prywatne materiaÅ‚y. Bardzo siÄ™ wstydzÄ™ Å¼e daÅ‚em siÄ™ w to wmanewrowaÄ‡.";
          if (m.indexOf("skad") >= 0 || m.indexOf("skÄ…d") >= 0)
            return "PoznaliÅ›my siÄ™ na randkowym portalu. Potem zaczÄ…Å‚ szantaÅ¼owaÄ‡.";
        }
        // PODSZYWANIE
        if (c.type == "PODSZYWANIE") {
          if (m.indexOf("zdjec") >= 0 || m.indexOf("zdjÄ™c") >= 0)
            return "Tak, uÅ¼ywajÄ… mojego zdjÄ™cia! Ukradli je z mojego profilu!";
          if (m.indexOf("zglos") >= 0 || m.indexOf("zgÅ‚os") >= 0)
            return "ZgÅ‚aszaÅ‚em do platformy ale ignorujÄ… moje zgÅ‚oszenia od tygodni.";
          if (m.indexOf("szkod") >= 0 || m.indexOf("strac") >= 0)
            return "StraciÅ‚em przez to klientÃ³w i kontrakty. Ludzie myÅ›lÄ… Å¼e to ja piszÄ™ te rzeczy!";
        }
        // UNIWERSALNE
        if (
          m.indexOf("podejrzew") >= 0 ||
          m.indexOf("kto to") >= 0 ||
          m.indexOf("sprawca") >= 0
        )
          return c.suspect
            ? "Podejrzewam Å¼e to: " + c.suspect + ". Ale nie mam 100% pewnoÅ›ci."
            : "Nie wiem dokÅ‚adnie kto za tym stoi. Dlatego potrzebujÄ™ pomocy!";
        if (
          m.indexOf("policj") >= 0 ||
          m.indexOf("zglosi") >= 0 ||
          m.indexOf("zgÅ‚osi") >= 0
        )
          return "Sprawa idzie do policji? ProszÄ™ mi powiedzieÄ‡ co mam robiÄ‡!";
        if (
          m.indexOf("sad") >= 0 ||
          m.indexOf("sÄ…d") >= 0 ||
          m.indexOf("rozpraw") >= 0
        )
          return "SÄ…d? BÄ™dÄ™ musiaÅ‚/a zeznawaÄ‡? TrochÄ™ siÄ™ bojÄ™ ale zrobiÄ™ co trzeba.";
        if (
          m.indexOf("falsz") >= 0 ||
          m.indexOf("faÅ‚sz") >= 0 ||
          m.indexOf("fake") >= 0 ||
          m.indexOf("podrobion") >= 0
        )
          return "UwaÅ¼a Pan/Pani Å¼e to sfaÅ‚szowane? Co mam teraz robiÄ‡?";
        if (
          m.indexOf("prawdzi") >= 0 ||
          m.indexOf("autentycz") >= 0 ||
          m.indexOf("oryginal") >= 0
        )
          return "Te dowody sÄ… prawdziwe? To dobrze czy Åºle dla mojej sprawy?";
        if (
          m.indexOf("dziek") >= 0 ||
          m.indexOf("dziÄ™k") >= 0 ||
          m.indexOf("super") >= 0 ||
          m.indexOf("swietnie") >= 0 ||
          m.indexOf("Å›wietnie") >= 0
        )
          return "To ja dziÄ™kujÄ™! Bardzo siÄ™ cieszÄ™ Å¼e ktoÅ› wreszcie mi pomaga!";
        if (m.indexOf("spokojnie") >= 0 || m.indexOf("nie martw") >= 0)
          return "DziÄ™kujÄ™... Staram siÄ™ nie panikowaÄ‡ ale to naprawdÄ™ stresujÄ…ca sytuacja.";
        if (m.indexOf("pomog") >= 0 || m.indexOf("zajm") >= 0)
          return "DziÄ™kujÄ™ bardzo! LiczÄ™ na Pana/PaniÄ…. Ta sprawa jest dla mnie bardzo waÅ¼na.";
        if (
          m.indexOf("opowiedz") >= 0 ||
          m.indexOf("od poczatku") >= 0 ||
          m.indexOf("od poczÄ…tku") >= 0 ||
          m.indexOf("historia") >= 0
        )
          return c.fullStory;
        if (
          m.indexOf("termin") >= 0 ||
          m.indexOf("czas") >= 0 ||
          m.indexOf("kiedy") >= 0
        )
          return "Im szybciej tym lepiej... Ta sytuacja mnie wykaÅ„cza psychicznie.";
        if (m.indexOf("?") >= 0)
          return (
            "Hmm, dobre pytanie. Powiem co wiem: " +
            c.fullStory.substring(0, 100) +
            "..."
          );
        return (
          "Rozumiem. JeÅ›li potrzebujesz wiÄ™cej screenÃ³w - mam jeszcze " +
          (3 - (c.extraScreensSent || 0)) +
          ". Wystarczy napisaÄ‡!"
        );
      }
      document.getElementById("close-chat").onclick = function () {
        document.getElementById("client-chat").style.display = "none";
        chatCaseIdx = null;
      };
      document.getElementById("chat-send").onclick = document.getElementById(
        "chat-send"
      ).ontouchend = function (e) {
        e.preventDefault();
        var txt = document.getElementById("chat-input").value.trim();
        if (!txt || chatCaseIdx === null) return;
        var c = G.activeCases[chatCaseIdx];
        if (!c.chatHistory) c.chatHistory = [];
        c.chatHistory.push({ from: "you", text: txt });
        document.getElementById("chat-input").value = "";
        renderChatMessages(c);
        setTimeout(function () {
          var resp = getClientResponse(c, txt);
          c.chatHistory.push({ from: "client", text: resp });
          renderChatMessages(c);
          saveGame();
        }, 1000 + Math.random() * 1000);
      };
      var currentVisitor = null;
      var agreedPrice = 0;
      function negotiatePrice(offered) {
        if (!currentVisitor) return;
        var base = currentVisitor.fee;
        var max = Math.floor(base * 2.5);
        var min = Math.floor(base * 0.5);
        var resp = document.getElementById("price-response");
        var priceBtn = document.getElementById("agreed-price");
        var isMale =
          currentVisitor.avatar.indexOf("ğŸ‘¨") >= 0 ||
          currentVisitor.avatar.indexOf("ğŸ§‘") >= 0;
        var honorific = isMale ? "Panie" : "Pani";
        if (offered <= 0 || isNaN(offered)) {
          resp.textContent = "ProszÄ™ wpisaÄ‡ konkretnÄ… kwotÄ™.";
          resp.style.color = "#f90";
          return;
        }
        if (offered < min) {
          resp.textContent =
            '"' +
            honorific +
            ", to stanowczo za maÅ‚o. Nie mogÄ™ siÄ™ na to zgodziÄ‡. Minimum to " +
            min +
            'ğŸ’°."';
          resp.style.color = "#f36";
          agreedPrice = 0;
          priceBtn.textContent = "---";
        } else if (offered <= base) {
          resp.textContent =
            '"Zgadzam siÄ™ na ' + offered + 'ğŸ’°. To uczciwa cena."';
          resp.style.color = "#0f8";
          agreedPrice = offered;
          priceBtn.textContent = offered;
        } else if (offered <= Math.floor(base * 1.5)) {
          resp.textContent =
            '"Hmm... ' +
            offered +
            'ğŸ’° to trochÄ™ duÅ¼o, ale zgoda. ZaleÅ¼y mi na rozwiÄ…zaniu sprawy."';
          resp.style.color = "#0f8";
          agreedPrice = offered;
          priceBtn.textContent = offered;
        } else if (offered <= max) {
          var chance = Math.random();
          if (chance > 0.4) {
            resp.textContent =
              '"' +
              offered +
              'ğŸ’°? *westchnienie* No dobrze, zgadzam siÄ™. Ale liczÄ™ na wyniki!"';
            resp.style.color = "#fc0";
            agreedPrice = offered;
            priceBtn.textContent = offered;
          } else {
            var counter = Math.floor(base * 1.3);
            resp.textContent =
              '"' +
              honorific +
              ", " +
              offered +
              "ğŸ’° to za duÅ¼o. MogÄ™ daÄ‡ maksymalnie " +
              counter +
              'ğŸ’°."';
            resp.style.color = "#f90";
            agreedPrice = counter;
            priceBtn.textContent = counter;
          }
        } else {
          resp.textContent =
            '"' +
            honorific +
            "! " +
            offered +
            'ğŸ’°?! To jakiÅ› Å¼art? ZnajdÄ™ kogoÅ› innego!"';
          resp.style.color = "#f36";
          agreedPrice = 0;
          priceBtn.textContent = "---";
        }
      }
      function spawnVisitor() {
        if (currentVisitor) {
          document.getElementById("visitor").style.display = "flex";
          return;
        }
        var avail = CASES.filter(function (c) {
          return (
            !G.completed.find(function (x) {
              return x.id == c.id;
            }) &&
            !G.activeCases.find(function (x) {
              return x.id == c.id;
            })
          );
        });
        if (!avail.length) {
          notify("Brak", "Wszystkie sprawy!");
          return;
        }
        currentVisitor = avail[Math.floor(Math.random() * avail.length)];
        var c = currentVisitor;
        document.getElementById("v-avatar").textContent = c.avatar;
        document.getElementById("v-name").textContent = c.name;
        document.getElementById("v-fee").textContent = c.fee;
        document.getElementById("visitor-complaint").innerHTML =
          "<strong>" +
          c.type +
          "</strong><br><br>" +
          c.fullStory +
          '<br><br><em style="color:#0ff">DowÃ³d: ' +
          c.evidence[0].tp +
          ' - "' +
          c.evidence[0].txt +
          '"</em>';
        document.getElementById("v-deadline").textContent = c.days;
        document.getElementById("v-penalty").textContent = c.pen;
        document.getElementById("price-input").value = c.fee;
        document.getElementById("price-response").textContent = "";
        document.getElementById("agreed-price").textContent = c.fee;
        agreedPrice = c.fee;
        document.getElementById("visitor").style.display = "flex";
        document.getElementById("price-input").oninput = function () {
          negotiatePrice(parseInt(this.value) || 0);
        };
      }
      document.getElementById("btn-accept").onclick = function () {
        if (!currentVisitor || agreedPrice <= 0) return;
        var c = currentVisitor;
        G.credits += agreedPrice;
        var nc = JSON.parse(JSON.stringify(c));
        nc.startDay = G.day;
        nc.agreedFee = agreedPrice;
        nc.evidence[0].verified = false;
        nc.evidence[0].verdict = null;
        nc.evidence[0].img = genImg(nc.evidence[0]);
        nc.extraScreens = 0;
        nc.chatHistory = [];
        G.results[nc.id] = {};
        G.activeCases.push(nc);
        G.selectedCase = G.activeCases.length - 1;
        currentVisitor = null;
        agreedPrice = 0;
        document.getElementById("visitor").style.display = "none";
        updateHUD();
        saveGame();
        notify("PrzyjÄ™to!", "+" + nc.agreedFee + "ğŸ’°");
      };
      document.getElementById("btn-reject").onclick = function () {
        currentVisitor = null;
        agreedPrice = 0;
        document.getElementById("visitor").style.display = "none";
      };
      function finishCase(idx, to) {
        var c = JSON.parse(JSON.stringify(G.activeCases[idx]));
        var correct = c.evidence[0].verdict == c.evidence[0].fake;
        G.activeCases.splice(idx, 1);
        delete G.results[c.id];
        G.selectedCase = G.activeCases.length ? 0 : null;
        saveGame();
        if (to == "SÄ…d" || to == "Policja") {
          exitPC();
          startScene(to, c, correct);
          return;
        }
      }
      function showResult(correct, rew, to) {
        document.getElementById("result-icon").textContent = correct
          ? "âœ“"
          : "âœ—";
        document.getElementById("result-icon").style.color = correct
          ? "#0f8"
          : "#f36";
        document.getElementById("result-title").textContent = correct
          ? "SUKCES!"
          : "BÅÄ„D!";
        document.getElementById("result-title").style.color = correct
          ? "#0f8"
          : "#f36";
        document.getElementById("result-msg").textContent = "â†’ " + to;
        document.getElementById("result-reward").textContent =
          (rew >= 0 ? "+" : "") + rew + "ğŸ’°";
        document.getElementById("result-reward").style.color =
          rew >= 0 ? "#fc0" : "#f36";
        document.getElementById("result").style.display = "flex";
      }
      document.getElementById("continue-btn").onclick = function () {
        document.getElementById("result").style.display = "none";
        G.day++;
        updateHUD();
        saveGame();
        renderPanel("case");
      };
      function initScene3D(type) {
        var canvas = document.getElementById("scene-canvas");
        sceneScene = new THREE.Scene();
        sceneScene.background = new THREE.Color(
          type == "SÄ…d" ? 0x1a1208 : 0x0a1020
        );
        sceneCamera = new THREE.PerspectiveCamera(
          60,
          innerWidth / (innerHeight * 0.4),
          0.1,
          100
        );
        sceneCamera.position.set(0, 1.6, 3);
        sceneRenderer = new THREE.WebGLRenderer({
          canvas: canvas,
          antialias: true,
        });
        sceneRenderer.setSize(innerWidth, innerHeight * 0.4);
        sceneScene.add(
          new THREE.AmbientLight(type == "SÄ…d" ? 0xffd090 : 0x4060ff, 0.5)
        );
        var light = new THREE.PointLight(
          type == "SÄ…d" ? 0xffcc66 : 0x3366ff,
          1,
          20
        );
        light.position.set(0, 4, 0);
        sceneScene.add(light);
        var floor = new THREE.Mesh(
          new THREE.PlaneGeometry(20, 20),
          new THREE.MeshBasicMaterial({
            color: type == "SÄ…d" ? 0x2a1a0a : 0x1a1a2a,
          })
        );
        floor.rotation.x = -Math.PI / 2;
        sceneScene.add(floor);
        if (type == "SÄ…d") {
          var bench = new THREE.Mesh(
            new THREE.BoxGeometry(4, 1.5, 1),
            new THREE.MeshBasicMaterial({ color: 0x4a2a10 })
          );
          bench.position.set(0, 0.75, -4);
          sceneScene.add(bench);
          var emblem = new THREE.Mesh(
            new THREE.CircleGeometry(0.5, 32),
            new THREE.MeshBasicMaterial({ color: 0xffd700 })
          );
          emblem.position.set(0, 2.5, -4.5);
          sceneScene.add(emblem);
        } else {
          var desk = new THREE.Mesh(
            new THREE.BoxGeometry(3, 1, 1.5),
            new THREE.MeshBasicMaterial({ color: 0x2a2a4a })
          );
          desk.position.set(0, 0.5, -3);
          sceneScene.add(desk);
          var lamp = new THREE.Mesh(
            new THREE.CylinderGeometry(0.1, 0.3, 0.4),
            new THREE.MeshBasicMaterial({ color: 0x4080ff })
          );
          lamp.position.set(1, 1.2, -3);
          sceneScene.add(lamp);
        }
        var stx = 0,
          sty = 0;
        canvas.ontouchstart = function (e) {
          stx = e.touches[0].clientX;
          sty = e.touches[0].clientY;
        };
        canvas.ontouchmove = function (e) {
          sceneRotY -= (e.touches[0].clientX - stx) * 0.005;
          sceneRotX = Math.max(
            -0.5,
            Math.min(0.5, sceneRotX - (e.touches[0].clientY - sty) * 0.005)
          );
          stx = e.touches[0].clientX;
          sty = e.touches[0].clientY;
        };
        canvas.onmousemove = function (e) {
          if (e.buttons) {
            sceneRotY -= e.movementX * 0.003;
            sceneRotX = Math.max(
              -0.5,
              Math.min(0.5, sceneRotX - e.movementY * 0.003)
            );
          }
        };
        animateScene();
      }
      function animateScene() {
        if (document.getElementById("scene-overlay").style.display != "flex")
          return;
        requestAnimationFrame(animateScene);
        sceneCamera.rotation.order = "YXZ";
        sceneCamera.rotation.y = sceneRotY;
        sceneCamera.rotation.x = sceneRotX;
        sceneRenderer.render(sceneScene, sceneCamera);
      }
      function startScene(type, caseData, correct) {
        sceneData = {
          type: type,
          caseData: caseData,
          correct: correct,
          phase: 0,
          allTexts: "",
        };
        sceneRotY = 0;
        sceneRotX = 0;
        document.getElementById("scene-overlay").style.display = "flex";
        document.getElementById("scene-result").style.display = "none";
        document.getElementById("scene-dialogue").style.display = "block";
        initScene3D(type);
        animateScene();
        runScenePhase();
      }
      function analyzePlayerText(txt) {
        var score = 0;
        var result = {};
        var kw = {
          evidence: [
            "dowod",
            "screen",
            "zrzut",
            "nagranie",
            "mail",
            "wiadomo",
            "sms",
            "foto",
            "zdjÄ™ci",
            "plik",
            "dokument",
            "wyciÄ…g",
            "log",
            "historia",
            "backup",
          ],
          technical: [
            "metadan",
            "analiz",
            "exif",
            "ip",
            "adres",
            "lokalizacj",
            "timestamp",
            "hash",
            "sygnatur",
            "photoshop",
            "edycj",
            "manipulacj",
            "faÅ‚sz",
          ],
          professional: [
            "wysoki sÄ…dzie",
            "panie oficerze",
            "pani oficer",
            "przedstawiam",
            "wnoszÄ™",
            "oÅ›wiadczam",
            "zeznaj",
            "potwierdzam",
          ],
          uncertain: [
            "nie wiem",
            "moÅ¼e",
            "chyba",
            "wydaje mi siÄ™",
            "nie jestem pewien",
            "trudno powiedzieÄ‡",
            "moÅ¼liwe",
            "prawdopodobnie",
            "nie pamiÄ™tam",
          ],
          aggressive: [
            "kÅ‚am",
            "oszust",
            "przestÄ™pc",
            "bandyt",
            "zÅ‚odziej",
            "Å›winia",
            "idiota",
            "gÅ‚upi",
          ],
          urgent: [
            "pilne",
            "szybko",
            "natychmiast",
            "teraz",
            "zaraz",
            "niebezpiecz",
            "grozi",
            "Å¼yci",
            "zdrowi",
            "przemoc",
          ],
          suspect: [
            "znam",
            "wiem kto",
            "to jest",
            "nazwisko",
            "adres",
            "mieszka",
            "pracuje",
            "numer",
            "telefon",
            "profil",
          ],
          victim: [
            "ofiara",
            "pokrzywdzon",
            "bezpiecz",
            "strach",
            "boi siÄ™",
            "ukrywa",
            "chroni",
            "pomoc",
          ],
          weak: [
            "tylko",
            "trochÄ™",
            "niewiele",
            "maÅ‚o",
            "sam",
            "jeden",
            "moÅ¼e byÄ‡",
          ],
          strong: [
            "pewny",
            "na pewno",
            "jednoznaczn",
            "bezsprzeczn",
            "niezbity",
            "oczywist",
            "ewidentn",
          ],
          legal: [
            "paragraf",
            "artykuÅ‚",
            "kodeks",
            "ustawa",
            "prawo",
            "przepis",
            "sankcj",
          ],
          emotional: [
            "proszÄ™",
            "bÅ‚agam",
            "pomÃ³Å¼",
            "ratuj",
            "straszn",
            "okropn",
            "koszmar",
          ],
        };
        for (var cat in kw) {
          result[cat] = 0;
          for (var i = 0; i < kw[cat].length; i++) {
            if (txt.indexOf(kw[cat][i]) >= 0) {
              result[cat]++;
              score +=
                cat == "uncertain" || cat == "weak" || cat == "aggressive"
                  ? -2
                  : 2;
            }
          }
        }
        result.score = score;
        result.hasEvidence = result.evidence > 0 || result.technical > 0;
        result.isPro = result.professional > 0;
        result.isUnsure = result.uncertain > 0 || result.weak > 1;
        result.isAggressive = result.aggressive > 0;
        result.isUrgent = result.urgent > 0;
        result.knowsSuspect = result.suspect > 0;
        result.victimDanger = result.urgent > 0 && result.victim > 0;
        result.isStrong = result.strong > 0 && result.evidence > 1;
        result.isEmotional = result.emotional > 0;
        result.isLegal = result.legal > 0;
        result.length = txt.length;
        return result;
      }

      function getDefResp(a, txt) {
        if (a.isUnsure && a.length < 50)
          return "Wysoki SÄ…dzie! To jest Å¼art? OskarÅ¼yciel sam przyznaje Å¼e nie jest pewien i nie potrafi nawet sensownie opisaÄ‡ sprawy! Å»Ä…dam natychmiastowego uniewinnienia!";
        if (a.isUnsure)
          return 'Wysoki SÄ…dzie! SÅ‚yszeliÅ›cie te wahania? "MoÅ¼e", "chyba"... To nie sÄ… sÅ‚owa kogoÅ› kto ma twarde dowody!';
        if (a.isAggressive)
          return "Sprzeciw! OskarÅ¼yciel zamiast faktÃ³w rzuca obelgi! To Å›wiadczy o braku argumentÃ³w! ProszÄ™ o upomnienie!";
        if (a.isEmotional && !a.hasEvidence)
          return "Wysoki SÄ…dzie, widzÄ™ tu duÅ¼o emocji, ale zero konkretnych dowodÃ³w. Emocje to nie dowody!";
        if (txt.indexOf("photoshop") >= 0 || txt.indexOf("edyt") >= 0)
          return 'OskarÅ¼yciel twierdzi Å¼e wykryÅ‚ edycjÄ™? A moÅ¼e to ON sfabrykowaÅ‚ te tak zwane "dowody"? KaÅ¼dy moÅ¼e coÅ› napisaÄ‡!';
        if (txt.indexOf("metadan") >= 0)
          return "Metadane? Wysoki SÄ…dzie, kaÅ¼dy nastolatek umie zmieniÄ‡ metadane pliku! To Å¼aden dowÃ³d!";
        if (a.technical > 2 && a.evidence > 1)
          return "Te... te techniczne bzdury... Wysoki SÄ…dzie, wnoszÄ™ o powoÅ‚anie NIEZALEÅ»NEGO biegÅ‚ego! Nie moÅ¼emy ufaÄ‡ analizom oskarÅ¼yciela!";
        if (a.isStrong)
          return "Mimo pewnoÅ›ci siebie oskarÅ¼yciela, wciÄ…Å¼ nie widzÄ™ NIEBITYCH dowodÃ³w! MÃ³j klient jest niewinny!";
        if (a.hasEvidence)
          return 'Te tak zwane "dowody" mogÅ‚y zostaÄ‡ sfabrykowane! W dobie AI wszystko moÅ¼na podrobiÄ‡! To nic nie dowodzi!';
        if (a.isLegal)
          return "OskarÅ¼yciel cytuje paragrafy, ale czy naprawdÄ™ rozumie prawo? Interpretacja jest wysoce wÄ…tpliwa!";
        if (a.length < 30)
          return "To wszystko? TAK KRÃ“TKA wypowiedÅº ma byÄ‡ oskarÅ¼eniem? Åšmieszne! Å»Ä…dam uniewinnienia!";
        return "Wysoki SÄ…dzie, oskarÅ¼yciel nie przedstawiÅ‚ Å¼adnych konkretnych, niepodwaÅ¼alnych dowodÃ³w! Å»Ä…dam uniewinnienia mojego klienta!";
      }

      function getJudgeResp(a, txt) {
        if (a.isAggressive)
          return "ProszÄ™ o spokÃ³j i powagÄ™! To jest sala sÄ…dowa. NastÄ™pne takie zachowanie skoÅ„czy siÄ™ karÄ… porzÄ…dkowÄ…. ProszÄ™ trzymaÄ‡ siÄ™ faktÃ³w.";
        if (a.isUnsure && a.length < 50)
          return "Panie oskarÅ¼ycielu, Pana wypowiedÅº jest bardzo niepewna i krÃ³tka. Czy jest Pan przygotowany do tej rozprawy?";
        if (a.isUnsure)
          return "SÅ‚yszÄ™ w Pana sÅ‚owach niepewnoÅ›Ä‡. SÄ…d potrzebuje PEWNOÅšCI, nie domysÅ‚Ã³w. Czy ma Pan twarde dowody?";
        if (a.isEmotional && !a.hasEvidence)
          return "Rozumiem emocje, ale sÄ…d opiera siÄ™ na faktach i dowodach, nie na uczuciach. ProszÄ™ o konkrety.";
        if (a.isPro && a.isStrong)
          return "DziÄ™kujÄ™ za profesjonalne i pewne przedstawienie sprawy. SÄ…d weÅºmie pod uwagÄ™ przedstawione argumenty.";
        if (a.isPro && a.hasEvidence)
          return "DziÄ™kujÄ™. WidzÄ™ Å¼e jest Pan przygotowany. ProszÄ™ kontynuowaÄ‡.";
        if (a.technical > 2)
          return "Rozumiem Å¼e sprawa ma aspekt techniczny. Czy te analizy byÅ‚y przeprowadzone zgodnie ze standardami?";
        if (a.hasEvidence && !a.isUnsure)
          return "Dobrze, mamy wiÄ™c jakieÅ› dowody. SÄ…d je rozpatrzy.";
        if (a.isLegal)
          return "WidzÄ™ Å¼e zna Pan przepisy. ProszÄ™ jednak pamiÄ™taÄ‡ Å¼e interpretacja prawa naleÅ¼y do sÄ…du.";
        if (a.length > 200 && a.hasEvidence)
          return "DziÄ™kujÄ™ za szczegÃ³Å‚owe wyjaÅ›nienie. SÄ…d ma teraz peÅ‚niejszy obraz sprawy.";
        if (a.length < 30)
          return "To bardzo krÃ³tka wypowiedÅº. Czy nie ma Pan nic wiÄ™cej do dodania?";
        return "Rozumiem. ProszÄ™ kontynuowaÄ‡ i przedstawiÄ‡ wiÄ™cej szczegÃ³Å‚Ã³w.";
      }

      function getPolResp(a, txt) {
        if (a.isAggressive)
          return "ProszÄ™ siÄ™ uspokoiÄ‡. Rozumiem Å¼e jest Pan zdenerwowany, ale potrzebujÄ™ konkretnych informacji, nie emocji.";
        if (a.isUnsure && a.length < 50)
          return "Hmm, nie brzmi to przekonujÄ…co. PotrzebujÄ™ konkretÃ³w Å¼eby podjÄ…Ä‡ dziaÅ‚ania. Kto, co, kiedy, gdzie?";
        if (a.isUnsure)
          return 'SÅ‚yszÄ™ duÅ¼o niepewnoÅ›ci. Trudno mi dziaÅ‚aÄ‡ na podstawie "moÅ¼e" i "chyba". Ma Pan coÅ› konkretnego?';
        if (a.isUrgent && a.victimDanger)
          return "Rozumiem Å¼e sytuacja jest powaÅ¼na. Natychmiast wyÅ›lÄ™ patrol do ofiary. ProszÄ™ kontynuowaÄ‡ zgÅ‚oszenie.";
        if (a.isUrgent)
          return "OK, widzÄ™ Å¼e sprawa jest pilna. ProszÄ™ szybko podaÄ‡ najwaÅ¼niejsze fakty.";
        if (a.isPro && a.hasEvidence)
          return "Dobrze, widzÄ™ Å¼e jest Pan przygotowany i ma dowody. To uÅ‚atwi sprawÄ™.";
        if (a.hasEvidence && a.technical > 1)
          return "O, ma Pan analizy techniczne? To moÅ¼e byÄ‡ kluczowe. Zabezpieczymy te materiaÅ‚y.";
        if (a.hasEvidence)
          return "Dobrze, mamy jakieÅ› dowody. Screeny, nagrania - to podstawa do dziaÅ‚ania.";
        if (a.knowsSuspect)
          return "Zna Pan podejrzanego? To bardzo waÅ¼ne. ProszÄ™ podaÄ‡ wszystkie szczegÃ³Å‚y.";
        if (a.isEmotional)
          return "Rozumiem Å¼e to trudna sytuacja. ProszÄ™ siÄ™ uspokoiÄ‡ i podaÄ‡ mi fakty po kolei.";
        if (a.length > 200)
          return "OK, mam sporo informacji. Zaczynam rozumieÄ‡ sytuacjÄ™.";
        if (a.length < 30)
          return "To trochÄ™ maÅ‚o. PotrzebujÄ™ wiÄ™cej szczegÃ³Å‚Ã³w Å¼eby podjÄ…Ä‡ dziaÅ‚ania.";
        return "Rozumiem. ProszÄ™ kontynuowaÄ‡ - potrzebujÄ™ peÅ‚nego obrazu sytuacji.";
      }

      function getSceneOutcome(d) {
        var txt = d.allTexts ? d.allTexts.toLowerCase() : "";
        var c = d.caseData;
        var keywordsFound = 0;
        if (c.keywords) {
          for (var i = 0; i < c.keywords.length; i++) {
            if (txt.indexOf(c.keywords[i]) >= 0) keywordsFound++;
          }
        }
        var keywordScore =
          keywordsFound / Math.max(1, c.keywords ? c.keywords.length : 1);
        var isEmpty = txt.length < 30;
        var mentionedEvidence =
          txt.indexOf("dowod") >= 0 ||
          txt.indexOf("screen") >= 0 ||
          txt.indexOf("analiz") >= 0 ||
          txt.indexOf("metadan") >= 0;

        var playerVerdict = c.evidence[0].verdict;
        var realFake = c.evidence[0].fake;
        var wasCorrect = playerVerdict == realFake;

        var saidFake =
          txt.indexOf("faÅ‚sz") >= 0 ||
          txt.indexOf("fake") >= 0 ||
          txt.indexOf("podrobion") >= 0 ||
          txt.indexOf("sfaÅ‚sz") >= 0 ||
          txt.indexOf("zmodyf") >= 0 ||
          txt.indexOf("edytow") >= 0;
        var saidReal =
          txt.indexOf("prawdzi") >= 0 ||
          txt.indexOf("autentycz") >= 0 ||
          txt.indexOf("oryginal") >= 0 ||
          txt.indexOf("prawda") >= 0;

        var speechMatchesVerdict =
          (playerVerdict && saidFake) || (!playerVerdict && saidReal);
        var speechContradicts =
          (playerVerdict && saidReal) || (!playerVerdict && saidFake);

        var accusedClient =
          txt.indexOf("klient") >= 0 &&
          (txt.indexOf("kÅ‚am") >= 0 ||
            txt.indexOf("sfaÅ‚sz") >= 0 ||
            txt.indexOf("oszuk") >= 0 ||
            txt.indexOf("winn") >= 0);
        accusedClient =
          accusedClient ||
          (txt.indexOf(c.name.split(" ")[0].toLowerCase()) >= 0 &&
            (txt.indexOf("kÅ‚am") >= 0 ||
              txt.indexOf("sfaÅ‚sz") >= 0 ||
              txt.indexOf("winn") >= 0));

        if (isEmpty)
          return {
            type: "dismissed",
            msg: "Nie przedstawiono Å¼adnych argumentÃ³w.",
            rew: 0,
          };

        if (speechContradicts) {
          return {
            type: "contradiction",
            msg:
              "SPRZECZNOÅšÄ†! ZaznaczyÅ‚eÅ› Å¼e dowÃ³d jest " +
              (playerVerdict ? "FAÅSZYWY" : "PRAWDZIWY") +
              " ale mÃ³wisz Å¼e jest " +
              (saidFake ? "faÅ‚szywy" : "prawdziwy") +
              "!",
            rew: -Math.floor(c.fine * 0.5),
          };
        }

        if (c.clientLies) {
          if (accusedClient && realFake) {
            return {
              type: "client_guilty",
              msg:
                "BRAWO! WykryÅ‚eÅ› Å¼e to KLIENT sfaÅ‚szowaÅ‚ dowody! " +
                c.name +
                " prÃ³bowaÅ‚ wrobiÄ‡ niewinnÄ… osobÄ™!",
              rew: Math.floor(c.rew * 2),
            };
          }
          if (!accusedClient && wasCorrect) {
            return {
              type: "partial",
              msg: "DowÃ³d jest faÅ‚szywy, ale nie wskazaÅ‚eÅ› prawdziwego winnego - KLIENTA!",
              rew: Math.floor(c.rew * 0.3),
            };
          }
          if (!wasCorrect) {
            return {
              type: "wrong",
              msg: "BÅ‚Ä™dna analiza. DowÃ³d byÅ‚ sfaÅ‚szowany przez klienta!",
              rew: -c.fine,
            };
          }
        }

        if (accusedClient && !c.clientLies) {
          return {
            type: "wrong_accusation",
            msg: "OskarÅ¼yÅ‚eÅ› klienta ktÃ³ry mÃ³wiÅ‚ prawdÄ™! To pomyÅ‚ka!",
            rew: -c.fine,
          };
        }

        var wrongAccusation =
          !wasCorrect &&
          !c.clientLies &&
          (txt.indexOf("winn") >= 0 ||
            txt.indexOf("skazaÄ‡") >= 0 ||
            txt.indexOf("aresztowaÄ‡") >= 0);
        if (wrongAccusation)
          return {
            type: "suspend",
            msg: "FaÅ‚szywe oskarÅ¼enie niewinnej osoby!",
            rew: 0,
          };

        if (wasCorrect) {
          if (speechMatchesVerdict && keywordScore > 0.4 && mentionedEvidence)
            return {
              type: "full_win",
              msg: "DoskonaÅ‚e! Analiza poprawna, zeznania spÃ³jne, argumenty mocne!",
              rew: Math.floor(c.rew * 1.5),
            };
          if (speechMatchesVerdict && keywordScore > 0.25)
            return {
              type: "win",
              msg: "Sprawa udowodniona. Zeznania zgodne z analizÄ….",
              rew: c.rew,
            };
          if (keywordScore > 0.2)
            return {
              type: "partial",
              msg: "Analiza poprawna ale sÅ‚abe argumenty w zeznaniach.",
              rew: Math.floor(c.rew * 0.5),
            };
          if (mentionedEvidence)
            return {
              type: "weak_win",
              msg: "Tylko dowody uratowaÅ‚y sprawÄ™.",
              rew: Math.floor(c.rew * 0.3),
            };
          return {
            type: "dismissed",
            msg: "Brak konkretÃ³w mimo poprawnej analizy.",
            rew: 0,
          };
        } else {
          if (keywordScore > 0.3)
            return {
              type: "fine",
              msg: "ZnaÅ‚eÅ› fakty ale Åºle oceniÅ‚eÅ› dowody!",
              rew: -c.fine,
            };
          return {
            type: "lose",
            msg: "BÅ‚Ä™dna analiza dowodÃ³w.",
            rew: -Math.floor(c.fine * 0.5),
          };
        }
      }
      function runScenePhase() {
        var d = sceneData,
          sp = document.getElementById("scene-speaker"),
          tx = document.getElementById("scene-text"),
          inp = document.getElementById("scene-input"),
          opts = document.getElementById("scene-options");
        inp.style.display = "none";
        opts.style.display = "none";
        var c = d.caseData;
        var txt = d.allTexts ? d.allTexts.toLowerCase() : "";
        var found = [];
        if (c.keywords) {
          for (var i = 0; i < c.keywords.length; i++) {
            if (txt.indexOf(c.keywords[i]) >= 0) found.push(c.keywords[i]);
          }
        }
        var mentionedSuspect =
          c.suspect && txt.indexOf(c.suspect.split(" ")[0].toLowerCase()) >= 0;
        var mentionedEvidence =
          txt.indexOf("dowod") >= 0 ||
          txt.indexOf("screen") >= 0 ||
          txt.indexOf("analiz") >= 0;
        var playerVerdict = c.evidence[0].verdict;
        var verdictWord = playerVerdict ? "FAÅSZYWY" : "PRAWDZIWY";

        if (d.type == "SÄ…d") {
          var phases = [
            {
              who: "judge",
              icon: "âš–ï¸ SÄ˜DZIA",
              say:
                "Rozprawa w sprawie " +
                c.name +
                ". Zarzut: " +
                c.type +
                ". OskarÅ¼ycielu, proszÄ™ opisaÄ‡ czego dotyczy ta sprawa.",
            },
            {
              who: "you",
              icon: "ğŸ” TY",
              say: "(Opisz sprawÄ™ wÅ‚asnymi sÅ‚owami - co siÄ™ staÅ‚o?)",
            },
            {
              who: "judge",
              icon: "âš–ï¸ SÄ˜DZIA",
              say: function () {
                if (txt.length < 20)
                  return "Panie oskarÅ¼ycielu, proszÄ™ mÃ³wiÄ‡ gÅ‚oÅ›niej. Czego dotyczy sprawa?";
                if (found.length > 3)
                  return "Rozumiem sytuacjÄ™. Kto wedÅ‚ug Pana jest sprawcÄ…?";
                return "ProszÄ™ doprecyzowaÄ‡ - jakie sÄ… szczegÃ³Å‚y tej sprawy?";
              },
            },
            {
              who: "you",
              icon: "ğŸ” TY",
              say: "(Kto jest podejrzany? Opisz sprawcÄ™)",
            },
            {
              who: "judge",
              icon: "âš–ï¸ SÄ˜DZIA",
              say: function () {
                if (mentionedSuspect)
                  return (
                    "Dobrze, mamy podejrzanego: " +
                    c.suspect.split("-")[0] +
                    ". Jakie ma Pan dowody?"
                  );
                if (
                  txt.indexOf("nie wiem") >= 0 ||
                  txt.indexOf("nie znam") >= 0
                )
                  return "Nie zna Pan sprawcy? Trudno bÄ™dzie prowadziÄ‡ sprawÄ™. A dowody?";
                return "Rozumiem. ProszÄ™ teraz przedstawiÄ‡ dowody.";
              },
            },
            {
              who: "you",
              icon: "ğŸ” TY",
              say: "(Jakie masz dowody? Co wykazaÅ‚a analiza?)",
            },
            {
              who: "defense",
              icon: "ğŸ‘” OBROÅƒCA",
              say: function () {
                if (mentionedEvidence && found.length > 4)
                  return 'Wysoki SÄ…dzie! Te tak zwane "dowody" moÅ¼na sfabrykowaÄ‡! Å»Ä…dam ich odrzucenia!';
                if (mentionedEvidence)
                  return "Sprzeciw! SkÄ…d wiemy Å¼e te dowody sÄ… prawdziwe?";
                return "Wysoki SÄ…dzie, oskarÅ¼yciel nie przedstawiÅ‚ Å»ADNYCH konkretnych dowodÃ³w!";
              },
            },
            {
              who: "judge",
              icon: "âš–ï¸ SÄ˜DZIA",
              say:
                "W analizie zaznaczyÅ‚ Pan Å¼e dowÃ³d jest " +
                verdictWord +
                ". Czy podtrzymuje Pan tÄ™ ocenÄ™? ProszÄ™ wyjaÅ›niÄ‡.",
            },
            {
              who: "you",
              icon: "ğŸ” TY",
              say: "(Powiedz czy dowÃ³d jest faÅ‚szywy czy prawdziwy i DLACZEGO - musi siÄ™ zgadzaÄ‡ z tym co zaznaczyÅ‚eÅ›!)",
            },
            {
              who: "judge",
              icon: "âš–ï¸ SÄ˜DZIA",
              say: function () {
                var saidFake =
                  txt.indexOf("faÅ‚sz") >= 0 || txt.indexOf("sfaÅ‚sz") >= 0;
                var saidReal =
                  txt.indexOf("prawdzi") >= 0 || txt.indexOf("autentycz") >= 0;
                if ((playerVerdict && saidReal) || (!playerVerdict && saidFake))
                  return "ChwileczkÄ™... Pan mÃ³wi co innego niÅ¼ zaznaczyÅ‚ w analizie! To powaÅ¼na sprzecznoÅ›Ä‡!";
                if ((playerVerdict && saidFake) || (!playerVerdict && saidReal))
                  return "Dobrze, zeznania zgadzajÄ… siÄ™ z analizÄ…. Ostatnie sÅ‚owo.";
                return "ProszÄ™ jasno powiedzieÄ‡ - dowÃ³d FAÅSZYWY czy PRAWDZIWY?";
              },
            },
            {
              who: "you",
              icon: "ğŸ” TY",
              say: "(Podsumuj - kto winny i dlaczego)",
            },
            {
              who: "judge",
              icon: "âš–ï¸ SÄ˜DZIA",
              say: "DziÄ™kujÄ™. SÄ…d wyda teraz wyrok...",
              verdict: true,
            },
          ];
        } else {
          var phases = [
            {
              who: "police",
              icon: "ğŸš” OFICER",
              say:
                "DzieÅ„ dobry. PrzyjmujÄ™ zgÅ‚oszenie. " +
                c.name +
                " - " +
                c.type +
                ". Co siÄ™ staÅ‚o?",
            },
            {
              who: "you",
              icon: "ğŸ” TY",
              say: "(Opisz sytuacjÄ™ - co siÄ™ wydarzyÅ‚o?)",
            },
            {
              who: "police",
              icon: "ğŸš” OFICER",
              say: function () {
                if (txt.length < 20)
                  return "ProszÄ™ mÃ³wiÄ‡ wyraÅºniej. Co dokÅ‚adnie siÄ™ staÅ‚o?";
                if (found.length > 2)
                  return "Rozumiem. Kto jest podejrzany o to przestÄ™pstwo?";
                return "PotrzebujÄ™ wiÄ™cej szczegÃ³Å‚Ã³w. Kto jest sprawcÄ…?";
              },
            },
            {
              who: "you",
              icon: "ğŸ” TY",
              say: "(Kto to zrobiÅ‚? Masz podejrzenia?)",
            },
            {
              who: "police",
              icon: "ğŸš” OFICER",
              say: function () {
                if (mentionedSuspect)
                  return (
                    "Mamy namiar: " +
                    c.suspect.split("-")[0] +
                    ". Jakie masz dowody przeciwko tej osobie?"
                  );
                if (txt.indexOf("nie wiem") >= 0)
                  return "Nie znasz sprawcy? BÄ™dzie trudniej. A dowody jakieÅ› masz?";
                return "OK. Jakie masz dowody?";
              },
            },
            {
              who: "you",
              icon: "ğŸ” TY",
              say: "(Jakie masz dowody? Screeny, maile, nagrania?)",
            },
            {
              who: "police",
              icon: "ğŸš” OFICER",
              say:
                "W analizie zaznaczyÅ‚eÅ› Å¼e dowÃ³d jest " +
                verdictWord +
                ". Czy to na pewno? Co dokÅ‚adnie wykazaÅ‚a analiza?",
            },
            {
              who: "you",
              icon: "ğŸ” TY",
              say: "(PotwierdÅº - dowÃ³d FAÅSZYWY czy PRAWDZIWY? Musi siÄ™ zgadzaÄ‡ z zaznaczeniem!)",
            },
            {
              who: "police",
              icon: "ğŸš” OFICER",
              say: function () {
                var saidFake =
                  txt.indexOf("faÅ‚sz") >= 0 || txt.indexOf("sfaÅ‚sz") >= 0;
                var saidReal =
                  txt.indexOf("prawdzi") >= 0 || txt.indexOf("autentycz") >= 0;
                if ((playerVerdict && saidReal) || (!playerVerdict && saidFake))
                  return "Zaraz, zaraz... MÃ³wisz co innego niÅ¼ masz w dokumentach! To siÄ™ nie zgadza!";
                if (c.type == "GROÅ¹BY" || c.type == "STALKING")
                  return "OK. Czy ofiara jest bezpieczna?";
                return "Rozumiem. Mam wystarczajÄ…co informacji.";
              },
            },
            { who: "you", icon: "ğŸ” TY", say: "(Ostatnie informacje)" },
            {
              who: "police",
              icon: "ğŸš” OFICER",
              say: "Dobrze, mam peÅ‚ny obraz. PodejmujÄ™ decyzjÄ™...",
              verdict: true,
            },
          ];
        }
        var ph = phases[d.phase];
        if (!ph) {
          showSceneVerdict();
          return;
        }
        sp.className = "scene-speaker " + ph.who;
        sp.textContent = ph.icon;
        var sayTxt = typeof ph.say === "function" ? ph.say() : ph.say;
        tx.textContent = sayTxt;
        if (ph.who != "you") speak(sayTxt, ph.who);
        if (ph.input || ph.who == "you") {
          inp.style.display = "block";
          document.getElementById("scene-textarea").value = "";
          document.getElementById("scene-textarea").focus();
        } else if (ph.verdict) {
          setTimeout(showSceneVerdict, 3000);
        } else {
          d.phase++;
          setTimeout(runScenePhase, 3000);
        }
      }
      document.getElementById("scene-submit").onclick = document.getElementById(
        "scene-submit"
      ).ontouchend = function (e) {
        e.preventDefault();
        var txt = document
          .getElementById("scene-textarea")
          .value.toLowerCase()
          .trim();
        document.getElementById("scene-input").style.display = "none";
        if (!sceneData.allTexts) sceneData.allTexts = "";
        sceneData.allTexts += " " + txt;
        document.getElementById("scene-text").textContent =
          txt.length > 0
            ? '"' + txt.substring(0, 80) + (txt.length > 80 ? "..." : "") + '"'
            : '"(milczenie)"';
        sceneData.phase++;
        setTimeout(runScenePhase, 2000);
      };
      function showSceneVerdict() {
        document.getElementById("scene-dialogue").style.display = "none";
        var res = document.getElementById("scene-result");
        res.style.display = "block";
        var title = document.getElementById("scene-verdict-title"),
          text = document.getElementById("scene-verdict-text");
        var outcome = getSceneOutcome(sceneData);
        var rew = outcome.rew;
        var msg = outcome.msg;
        var col = rew > 0 ? "#0f8" : rew == 0 ? "#f90" : "#f36";
        var speak_txt = "";
        if (outcome.type == "suspend") {
          title.textContent = "â›” ZAWIESZENIE!";
          title.style.color = "#f36";
          text.innerHTML =
            msg +
            '<br><br><span style="color:#f36">Licencja zawieszona na 2 godziny!</span>';
          speak_txt =
            sceneData.type == "SÄ…d"
              ? "Za faÅ‚szywe oskarÅ¼enie zawieszam Pana licencjÄ™!"
              : "Za faÅ‚szywe zgÅ‚oszenie nakÅ‚adam zawieszenie!";
          speak(speak_txt, sceneData.type == "SÄ…d" ? "judge" : "police");
          G.completed.push({
            id: sceneData.caseData.id,
            name: sceneData.caseData.name,
            rew: 0,
          });
          G.inbox.unshift({
            from: sceneData.type,
            body: "Licencja zawieszona za faÅ‚szywe oskarÅ¼enie.",
            read: false,
          });
          updateHUD();
          saveGame();
          setTimeout(function () {
            suspendPlayer(2);
          }, 3000);
          return;
        }
        if (outcome.type == "full_win")
          speak_txt =
            sceneData.type == "SÄ…d"
              ? "UznajÄ™ oskarÅ¼onego winnym! DoskonaÅ‚a praca!"
              : "Aresztujemy podejrzanego! Åšwietna robota!";
        else if (outcome.type == "win")
          speak_txt =
            sceneData.type == "SÄ…d"
              ? "UznajÄ™ oskarÅ¼onego winnym."
              : "Wszczynamy postÄ™powanie.";
        else if (outcome.type == "partial")
          speak_txt =
            sceneData.type == "SÄ…d"
              ? "CzÄ™Å›ciowo uznajÄ™ winÄ™."
              : "Przyjmujemy zgÅ‚oszenie.";
        else if (outcome.type == "weak_win")
          speak_txt = "SÅ‚abe argumenty, ale akceptujÄ™.";
        else if (outcome.type == "dismissed")
          speak_txt = "Sprawa umorzona. Brak dowodÃ³w.";
        else if (outcome.type == "fine")
          speak_txt = "NakÅ‚adam grzywnÄ™ za bÅ‚Ä™dne oskarÅ¼enie!";
        else if (outcome.type == "lose") speak_txt = "Odrzucam to zgÅ‚oszenie.";
        else speak_txt = "Sprawa rozpatrzona.";
        speak(speak_txt, sceneData.type == "SÄ…d" ? "judge" : "police");
        title.textContent =
          rew > 0 ? "âœ… SUKCES!" : rew == 0 ? "âš ï¸ UMORZONE" : "âŒ PORAÅ»KA!";
        title.style.color = col;
        var tax = getTotalTax();
        var taxAmount = rew > 0 ? Math.floor((rew * tax) / 100) : 0;
        var finalRew = rew - taxAmount;
        text.innerHTML =
          msg +
          '<br><br><span style="font-size:20px;color:' +
          col +
          '">' +
          (rew >= 0 ? "+" : "") +
          rew +
          "ğŸ’°</span>" +
          (taxAmount > 0
            ? '<br><span style="font-size:14px;color:#f90">-' +
              taxAmount +
              "ğŸ’° (" +
              tax +
              '% opÅ‚ata za narzÄ™dzia)</span><br><span style="font-size:16px;color:#0f8">= ' +
              finalRew +
              "ğŸ’° netto</span>"
            : "");
        G.credits = Math.max(0, G.credits + finalRew);
        G.completed.push({
          id: sceneData.caseData.id,
          name: sceneData.caseData.name,
          rew: rew,
        });
        G.inbox.unshift({ from: sceneData.type, body: msg, read: false });
        updateHUD();
        saveGame();
      }
      document.getElementById("scene-exit").onclick = document.getElementById(
        "scene-exit"
      ).ontouchend = function (e) {
        e.preventDefault();
        document.getElementById("scene-overlay").style.display = "none";
        G.day++;
        updateHUD();
        saveGame();
        renderPanel("case");
      };
      document.getElementById("start-btn").onclick = function () {
        document.getElementById("intro").style.display = "none";
        init3D();
        document.getElementById("touch-btn").onclick = function () {
          if (lookAt && !G.inPC) interact(lookAt);
        };
        setTimeout(function () {
          notify("Witaj!", "IdÅº do DRZWI");
        }, 500);
      };
      window.onresize = function () {
        if (camera && renderer) {
          camera.aspect = innerWidth / innerHeight;
          camera.updateProjectionMatrix();
          renderer.setSize(innerWidth, innerHeight);
        }
      };
      document.oncontextmenu = function (e) {
        e.preventDefault();
        return false;
      };
      var chatClientIdx = null;
      var mediatorHistory = [];
      var mediatorCaseIdx = null;
      function openMediatorChat() {
        mediatorCaseIdx = parseInt(document.getElementById("case-sel").value);
        var c = G.activeCases[mediatorCaseIdx];
        mediatorHistory = [];
        if (c) {
          mediatorHistory.push({
            from: "mediator",
            txt:
              "Witam, jestem poÅ›rednikiem prawnym. WidzÄ™ sprawÄ™: " +
              c.name +
              " (" +
              c.type +
              '). MogÄ™ doradziÄ‡ gdzie najlepiej jÄ… skierowaÄ‡. Napisz "porada" a za 50ğŸ’° powiem ci dokÅ‚adnie gdzie wysÅ‚aÄ‡ i dlaczego.',
          });
        } else {
          mediatorHistory.push({
            from: "mediator",
            txt: "Witam. Nie widzÄ™ wybranej sprawy. Wybierz sprawÄ™ z listy i wrÃ³Ä‡ do mnie.",
          });
        }
        renderMediatorMessages();
        document.getElementById("mediator-chat").style.display = "flex";
      }
      function renderMediatorMessages() {
        var h = "";
        for (var i = 0; i < mediatorHistory.length; i++) {
          var m = mediatorHistory[i];
          h +=
            '<div style="margin-bottom:10px;text-align:' +
            (m.from == "ty" ? "right" : "left") +
            '"><div style="display:inline-block;background:' +
            (m.from == "ty" ? "#fc0" : "#2a2a4e") +
            ";color:" +
            (m.from == "ty" ? "#000" : "#fff") +
            ';padding:8px 12px;border-radius:10px;max-width:80%;font-size:13px;white-space:pre-wrap">' +
            m.txt +
            "</div></div>";
        }
        document.getElementById("mediator-messages").innerHTML = h;
        document.getElementById("mediator-messages").scrollTop = 9999;
      }
      function getMediatorResponse(msg) {
        var m = msg.toLowerCase();
        var c = G.activeCases[mediatorCaseIdx];
        if (!c)
          return "Nie widzÄ™ Å¼adnej wybranej sprawy. Zamknij okno, wybierz sprawÄ™ z listy i wrÃ³Ä‡.";
        if (
          m.indexOf("porada") >= 0 ||
          m.indexOf("tak") >= 0 ||
          m.indexOf("chcÄ™") >= 0 ||
          m.indexOf("dawaj") >= 0 ||
          m.indexOf("mÃ³w") >= 0
        ) {
          if (G.credits < 50)
            return (
              "âŒ Nie masz wystarczajÄ…cych Å›rodkÃ³w. Potrzebujesz 50ğŸ’°, masz tylko " +
              G.credits +
              "ğŸ’°."
            );
          G.credits -= 50;
          updateHUD();
          saveGame();
          var best = "";
          var reason = "";
          if (c.type == "GROÅ¹BY") {
            best = "ğŸš” POLICJA";
            reason =
              "GroÅºby to sprawa karna. Policja moÅ¼e natychmiast dziaÅ‚aÄ‡, zabezpieczyÄ‡ dowody i zapewniÄ‡ ochronÄ™ ofierze. MogÄ… teÅ¼ namierzyÄ‡ sprawcÄ™.";
          } else if (c.type == "STALKING") {
            best = "ğŸš” POLICJA";
            reason =
              "Stalking to przestÄ™pstwo Å›cigane z urzÄ™du. Policja moÅ¼e wydaÄ‡ zakaz zbliÅ¼ania siÄ™ i monitorowaÄ‡ sprawcÄ™. Ofiara dostanie ochronÄ™.";
          } else if (c.type == "ZNIESÅAWIENIE") {
            best = "âš–ï¸ SÄ„D";
            reason =
              "ZniesÅ‚awienie to sprawa cywilna. SÄ…d moÅ¼e nakazaÄ‡ usuniÄ™cie faÅ‚szywych treÅ›ci, przeprosiny i odszkodowanie finansowe.";
          } else if (c.type == "PODSZYWANIE") {
            best = "âš–ï¸ SÄ„D";
            reason =
              "Podszywanie siÄ™ pod kogoÅ› to naruszenie dÃ³br osobistych. SÄ…d moÅ¼e nakazaÄ‡ usuniÄ™cie faÅ‚szywego profilu i zasÄ…dziÄ‡ odszkodowanie.";
          } else if (c.type == "OSZUSTWO") {
            best = "ğŸš” POLICJA";
            reason =
              "Oszustwo to przestÄ™pstwo. Policja wszczyna Å›ledztwo, moÅ¼e zablokowaÄ‡ konta bankowe sprawcy i odzyskaÄ‡ pieniÄ…dze.";
          } else if (c.type == "HACKING") {
            best = "ğŸš” POLICJA";
            reason =
              "WÅ‚amanie na konto to cyberprzestÄ™pstwo. Policja ma wydziaÅ‚ cyberprzestÄ™pczoÅ›ci ktÃ³ry moÅ¼e namierzyÄ‡ hakera.";
          } else if (c.type == "SZANTAÅ»") {
            best = "ğŸš” POLICJA lub ğŸ“‹ PROKURATURA";
            reason =
              "SzantaÅ¼ to powaÅ¼ne przestÄ™pstwo zagroÅ¼one wiÄ™zieniem. Policja dziaÅ‚a szybciej, prokuratura ma wiÄ™cej zasobÃ³w na trudne sprawy.";
          } else if (c.type == "WYÅUDZENIE") {
            best = "ğŸ“‹ PROKURATURA";
            reason =
              "WyÅ‚udzenia na duÅ¼Ä… skalÄ™ najlepiej kierowaÄ‡ do prokuratury - prowadzÄ… kompleksowe Å›ledztwa finansowe.";
          } else {
            best = "ğŸš” POLICJA";
            reason =
              "W razie wÄ…tpliwoÅ›ci policja to bezpieczny wybÃ³r - przekaÅ¼Ä… sprawÄ™ dalej jeÅ›li trzeba.";
          }
          return (
            "âœ… PORADA (-50ğŸ’°)\n\nâ¡ï¸ WyÅ›lij do: " +
            best +
            "\n\nğŸ“ Dlaczego: " +
            reason +
            "\n\nPowodzenia!"
          );
        }
        if (
          m.indexOf("ile") >= 0 ||
          m.indexOf("koszt") >= 0 ||
          m.indexOf("cena") >= 0
        )
          return 'Porada kosztuje 50ğŸ’°. Napisz "porada" Å¼eby jÄ… otrzymaÄ‡.';
        if (m.indexOf("dziÄ™ki") >= 0 || m.indexOf("dziÄ™kujÄ™") >= 0)
          return "Nie ma za co! Powodzenia ze sprawÄ….";
        if (
          m.indexOf("hej") >= 0 ||
          m.indexOf("czeÅ›Ä‡") >= 0 ||
          m.indexOf("siema") >= 0
        )
          return 'Witam! Napisz "porada" jeÅ›li chcesz wiedzieÄ‡ gdzie wysÅ‚aÄ‡ sprawÄ™ (50ğŸ’°).';
        return 'Napisz "porada" Å¼eby otrzymaÄ‡ rekomendacjÄ™ za 50ğŸ’°, lub "ile" Å¼eby sprawdziÄ‡ cenÄ™.';
      }
      document.getElementById("close-mediator").onclick = function () {
        document.getElementById("mediator-chat").style.display = "none";
      };
      document.getElementById("mediator-send").onclick =
        document.getElementById("mediator-send").ontouchend = function (e) {
          e.preventDefault();
          var input = document.getElementById("mediator-input");
          var txt = input.value.trim();
          if (!txt) return;
          mediatorHistory.push({ from: "ty", txt: txt });
          var resp = getMediatorResponse(txt);
          setTimeout(function () {
            mediatorHistory.push({ from: "mediator", txt: resp });
            renderMediatorMessages();
          }, 500);
          input.value = "";
          renderMediatorMessages();
        };
    </script>
  </body>
</html>
